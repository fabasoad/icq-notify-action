(()=>{var e={351:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){if(n===undefined)n=r;Object.defineProperty(e,n,{enumerable:true,get:function(){return t[r]}})}:function(e,t,r,n){if(n===undefined)n=r;e[n]=t[r]});var i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)if(r!=="default"&&Object.hasOwnProperty.call(e,r))n(t,e,r);i(t,e);return t};Object.defineProperty(t,"__esModule",{value:true});t.issue=t.issueCommand=void 0;const s=o(r(87));const a=r(278);function issueCommand(e,t,r){const n=new Command(e,t,r);process.stdout.write(n.toString()+s.EOL)}t.issueCommand=issueCommand;function issue(e,t=""){issueCommand(e,{},t)}t.issue=issue;const l="::";class Command{constructor(e,t,r){if(!e){e="missing.command"}this.command=e;this.properties=t;this.message=r}toString(){let e=l+this.command;if(this.properties&&Object.keys(this.properties).length>0){e+=" ";let t=true;for(const r in this.properties){if(this.properties.hasOwnProperty(r)){const n=this.properties[r];if(n){if(t){t=false}else{e+=","}e+=`${r}=${escapeProperty(n)}`}}}}e+=`${l}${escapeData(this.message)}`;return e}}function escapeData(e){return a.toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A")}function escapeProperty(e){return a.toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/:/g,"%3A").replace(/,/g,"%2C")}},186:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){if(n===undefined)n=r;Object.defineProperty(e,n,{enumerable:true,get:function(){return t[r]}})}:function(e,t,r,n){if(n===undefined)n=r;e[n]=t[r]});var i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)if(r!=="default"&&Object.hasOwnProperty.call(e,r))n(t,e,r);i(t,e);return t};var s=this&&this.__awaiter||function(e,t,r,n){function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,i){function fulfilled(e){try{step(n.next(e))}catch(e){i(e)}}function rejected(e){try{step(n["throw"](e))}catch(e){i(e)}}function step(e){e.done?r(e.value):adopt(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:true});t.getIDToken=t.getState=t.saveState=t.group=t.endGroup=t.startGroup=t.info=t.notice=t.warning=t.error=t.debug=t.isDebug=t.setFailed=t.setCommandEcho=t.setOutput=t.getBooleanInput=t.getMultilineInput=t.getInput=t.addPath=t.setSecret=t.exportVariable=t.ExitCode=void 0;const a=r(351);const l=r(717);const u=r(278);const c=o(r(87));const p=o(r(622));const d=r(41);var h;(function(e){e[e["Success"]=0]="Success";e[e["Failure"]=1]="Failure"})(h=t.ExitCode||(t.ExitCode={}));function exportVariable(e,t){const r=u.toCommandValue(t);process.env[e]=r;const n=process.env["GITHUB_ENV"]||"";if(n){const t="_GitHubActionsFileCommandDelimeter_";const n=`${e}<<${t}${c.EOL}${r}${c.EOL}${t}`;l.issueCommand("ENV",n)}else{a.issueCommand("set-env",{name:e},r)}}t.exportVariable=exportVariable;function setSecret(e){a.issueCommand("add-mask",{},e)}t.setSecret=setSecret;function addPath(e){const t=process.env["GITHUB_PATH"]||"";if(t){l.issueCommand("PATH",e)}else{a.issueCommand("add-path",{},e)}process.env["PATH"]=`${e}${p.delimiter}${process.env["PATH"]}`}t.addPath=addPath;function getInput(e,t){const r=process.env[`INPUT_${e.replace(/ /g,"_").toUpperCase()}`]||"";if(t&&t.required&&!r){throw new Error(`Input required and not supplied: ${e}`)}if(t&&t.trimWhitespace===false){return r}return r.trim()}t.getInput=getInput;function getMultilineInput(e,t){const r=getInput(e,t).split("\n").filter((e=>e!==""));return r}t.getMultilineInput=getMultilineInput;function getBooleanInput(e,t){const r=["true","True","TRUE"];const n=["false","False","FALSE"];const i=getInput(e,t);if(r.includes(i))return true;if(n.includes(i))return false;throw new TypeError(`Input does not meet YAML 1.2 "Core Schema" specification: ${e}\n`+`Support boolean input list: \`true | True | TRUE | false | False | FALSE\``)}t.getBooleanInput=getBooleanInput;function setOutput(e,t){process.stdout.write(c.EOL);a.issueCommand("set-output",{name:e},t)}t.setOutput=setOutput;function setCommandEcho(e){a.issue("echo",e?"on":"off")}t.setCommandEcho=setCommandEcho;function setFailed(e){process.exitCode=h.Failure;error(e)}t.setFailed=setFailed;function isDebug(){return process.env["RUNNER_DEBUG"]==="1"}t.isDebug=isDebug;function debug(e){a.issueCommand("debug",{},e)}t.debug=debug;function error(e,t={}){a.issueCommand("error",u.toCommandProperties(t),e instanceof Error?e.toString():e)}t.error=error;function warning(e,t={}){a.issueCommand("warning",u.toCommandProperties(t),e instanceof Error?e.toString():e)}t.warning=warning;function notice(e,t={}){a.issueCommand("notice",u.toCommandProperties(t),e instanceof Error?e.toString():e)}t.notice=notice;function info(e){process.stdout.write(e+c.EOL)}t.info=info;function startGroup(e){a.issue("group",e)}t.startGroup=startGroup;function endGroup(){a.issue("endgroup")}t.endGroup=endGroup;function group(e,t){return s(this,void 0,void 0,(function*(){startGroup(e);let r;try{r=yield t()}finally{endGroup()}return r}))}t.group=group;function saveState(e,t){a.issueCommand("save-state",{name:e},t)}t.saveState=saveState;function getState(e){return process.env[`STATE_${e}`]||""}t.getState=getState;function getIDToken(e){return s(this,void 0,void 0,(function*(){return yield d.OidcClient.getIDToken(e)}))}t.getIDToken=getIDToken},717:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){if(n===undefined)n=r;Object.defineProperty(e,n,{enumerable:true,get:function(){return t[r]}})}:function(e,t,r,n){if(n===undefined)n=r;e[n]=t[r]});var i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)if(r!=="default"&&Object.hasOwnProperty.call(e,r))n(t,e,r);i(t,e);return t};Object.defineProperty(t,"__esModule",{value:true});t.issueCommand=void 0;const s=o(r(747));const a=o(r(87));const l=r(278);function issueCommand(e,t){const r=process.env[`GITHUB_${e}`];if(!r){throw new Error(`Unable to find environment variable for file command ${e}`)}if(!s.existsSync(r)){throw new Error(`Missing file at path: ${r}`)}s.appendFileSync(r,`${l.toCommandValue(t)}${a.EOL}`,{encoding:"utf8"})}t.issueCommand=issueCommand},41:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,i){function fulfilled(e){try{step(n.next(e))}catch(e){i(e)}}function rejected(e){try{step(n["throw"](e))}catch(e){i(e)}}function step(e){e.done?r(e.value):adopt(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:true});t.OidcClient=void 0;const i=r(925);const o=r(702);const s=r(186);class OidcClient{static createHttpClient(e=true,t=10){const r={allowRetries:e,maxRetries:t};return new i.HttpClient("actions/oidc-client",[new o.BearerCredentialHandler(OidcClient.getRequestToken())],r)}static getRequestToken(){const e=process.env["ACTIONS_ID_TOKEN_REQUEST_TOKEN"];if(!e){throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_TOKEN env variable")}return e}static getIDTokenUrl(){const e=process.env["ACTIONS_ID_TOKEN_REQUEST_URL"];if(!e){throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_URL env variable")}return e}static getCall(e){var t;return n(this,void 0,void 0,(function*(){const r=OidcClient.createHttpClient();const n=yield r.getJson(e).catch((e=>{throw new Error(`Failed to get ID Token. \n \n        Error Code : ${e.statusCode}\n \n        Error Message: ${e.result.message}`)}));const i=(t=n.result)===null||t===void 0?void 0:t.value;if(!i){throw new Error("Response json body do not have ID Token field")}return i}))}static getIDToken(e){return n(this,void 0,void 0,(function*(){try{let t=OidcClient.getIDTokenUrl();if(e){const r=encodeURIComponent(e);t=`${t}&audience=${r}`}s.debug(`ID token url is ${t}`);const r=yield OidcClient.getCall(t);s.setSecret(r);return r}catch(e){throw new Error(`Error message: ${e.message}`)}}))}}t.OidcClient=OidcClient},278:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.toCommandProperties=t.toCommandValue=void 0;function toCommandValue(e){if(e===null||e===undefined){return""}else if(typeof e==="string"||e instanceof String){return e}return JSON.stringify(e)}t.toCommandValue=toCommandValue;function toCommandProperties(e){if(!Object.keys(e).length){return{}}return{title:e.title,file:e.file,line:e.startLine,endLine:e.endLine,col:e.startColumn,endColumn:e.endColumn}}t.toCommandProperties=toCommandProperties},702:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});class BasicCredentialHandler{constructor(e,t){this.username=e;this.password=t}prepareRequest(e){e.headers["Authorization"]="Basic "+Buffer.from(this.username+":"+this.password).toString("base64")}canHandleAuthentication(e){return false}handleAuthentication(e,t,r){return null}}t.BasicCredentialHandler=BasicCredentialHandler;class BearerCredentialHandler{constructor(e){this.token=e}prepareRequest(e){e.headers["Authorization"]="Bearer "+this.token}canHandleAuthentication(e){return false}handleAuthentication(e,t,r){return null}}t.BearerCredentialHandler=BearerCredentialHandler;class PersonalAccessTokenCredentialHandler{constructor(e){this.token=e}prepareRequest(e){e.headers["Authorization"]="Basic "+Buffer.from("PAT:"+this.token).toString("base64")}canHandleAuthentication(e){return false}handleAuthentication(e,t,r){return null}}t.PersonalAccessTokenCredentialHandler=PersonalAccessTokenCredentialHandler},925:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});const n=r(605);const i=r(211);const o=r(443);let s;var a;(function(e){e[e["OK"]=200]="OK";e[e["MultipleChoices"]=300]="MultipleChoices";e[e["MovedPermanently"]=301]="MovedPermanently";e[e["ResourceMoved"]=302]="ResourceMoved";e[e["SeeOther"]=303]="SeeOther";e[e["NotModified"]=304]="NotModified";e[e["UseProxy"]=305]="UseProxy";e[e["SwitchProxy"]=306]="SwitchProxy";e[e["TemporaryRedirect"]=307]="TemporaryRedirect";e[e["PermanentRedirect"]=308]="PermanentRedirect";e[e["BadRequest"]=400]="BadRequest";e[e["Unauthorized"]=401]="Unauthorized";e[e["PaymentRequired"]=402]="PaymentRequired";e[e["Forbidden"]=403]="Forbidden";e[e["NotFound"]=404]="NotFound";e[e["MethodNotAllowed"]=405]="MethodNotAllowed";e[e["NotAcceptable"]=406]="NotAcceptable";e[e["ProxyAuthenticationRequired"]=407]="ProxyAuthenticationRequired";e[e["RequestTimeout"]=408]="RequestTimeout";e[e["Conflict"]=409]="Conflict";e[e["Gone"]=410]="Gone";e[e["TooManyRequests"]=429]="TooManyRequests";e[e["InternalServerError"]=500]="InternalServerError";e[e["NotImplemented"]=501]="NotImplemented";e[e["BadGateway"]=502]="BadGateway";e[e["ServiceUnavailable"]=503]="ServiceUnavailable";e[e["GatewayTimeout"]=504]="GatewayTimeout"})(a=t.HttpCodes||(t.HttpCodes={}));var l;(function(e){e["Accept"]="accept";e["ContentType"]="content-type"})(l=t.Headers||(t.Headers={}));var u;(function(e){e["ApplicationJson"]="application/json"})(u=t.MediaTypes||(t.MediaTypes={}));function getProxyUrl(e){let t=o.getProxyUrl(new URL(e));return t?t.href:""}t.getProxyUrl=getProxyUrl;const c=[a.MovedPermanently,a.ResourceMoved,a.SeeOther,a.TemporaryRedirect,a.PermanentRedirect];const p=[a.BadGateway,a.ServiceUnavailable,a.GatewayTimeout];const d=["OPTIONS","GET","DELETE","HEAD"];const h=10;const f=5;class HttpClientError extends Error{constructor(e,t){super(e);this.name="HttpClientError";this.statusCode=t;Object.setPrototypeOf(this,HttpClientError.prototype)}}t.HttpClientError=HttpClientError;class HttpClientResponse{constructor(e){this.message=e}readBody(){return new Promise((async(e,t)=>{let r=Buffer.alloc(0);this.message.on("data",(e=>{r=Buffer.concat([r,e])}));this.message.on("end",(()=>{e(r.toString())}))}))}}t.HttpClientResponse=HttpClientResponse;function isHttps(e){let t=new URL(e);return t.protocol==="https:"}t.isHttps=isHttps;class HttpClient{constructor(e,t,r){this._ignoreSslError=false;this._allowRedirects=true;this._allowRedirectDowngrade=false;this._maxRedirects=50;this._allowRetries=false;this._maxRetries=1;this._keepAlive=false;this._disposed=false;this.userAgent=e;this.handlers=t||[];this.requestOptions=r;if(r){if(r.ignoreSslError!=null){this._ignoreSslError=r.ignoreSslError}this._socketTimeout=r.socketTimeout;if(r.allowRedirects!=null){this._allowRedirects=r.allowRedirects}if(r.allowRedirectDowngrade!=null){this._allowRedirectDowngrade=r.allowRedirectDowngrade}if(r.maxRedirects!=null){this._maxRedirects=Math.max(r.maxRedirects,0)}if(r.keepAlive!=null){this._keepAlive=r.keepAlive}if(r.allowRetries!=null){this._allowRetries=r.allowRetries}if(r.maxRetries!=null){this._maxRetries=r.maxRetries}}}options(e,t){return this.request("OPTIONS",e,null,t||{})}get(e,t){return this.request("GET",e,null,t||{})}del(e,t){return this.request("DELETE",e,null,t||{})}post(e,t,r){return this.request("POST",e,t,r||{})}patch(e,t,r){return this.request("PATCH",e,t,r||{})}put(e,t,r){return this.request("PUT",e,t,r||{})}head(e,t){return this.request("HEAD",e,null,t||{})}sendStream(e,t,r,n){return this.request(e,t,r,n)}async getJson(e,t={}){t[l.Accept]=this._getExistingOrDefaultHeader(t,l.Accept,u.ApplicationJson);let r=await this.get(e,t);return this._processResponse(r,this.requestOptions)}async postJson(e,t,r={}){let n=JSON.stringify(t,null,2);r[l.Accept]=this._getExistingOrDefaultHeader(r,l.Accept,u.ApplicationJson);r[l.ContentType]=this._getExistingOrDefaultHeader(r,l.ContentType,u.ApplicationJson);let i=await this.post(e,n,r);return this._processResponse(i,this.requestOptions)}async putJson(e,t,r={}){let n=JSON.stringify(t,null,2);r[l.Accept]=this._getExistingOrDefaultHeader(r,l.Accept,u.ApplicationJson);r[l.ContentType]=this._getExistingOrDefaultHeader(r,l.ContentType,u.ApplicationJson);let i=await this.put(e,n,r);return this._processResponse(i,this.requestOptions)}async patchJson(e,t,r={}){let n=JSON.stringify(t,null,2);r[l.Accept]=this._getExistingOrDefaultHeader(r,l.Accept,u.ApplicationJson);r[l.ContentType]=this._getExistingOrDefaultHeader(r,l.ContentType,u.ApplicationJson);let i=await this.patch(e,n,r);return this._processResponse(i,this.requestOptions)}async request(e,t,r,n){if(this._disposed){throw new Error("Client has already been disposed.")}let i=new URL(t);let o=this._prepareRequest(e,i,n);let s=this._allowRetries&&d.indexOf(e)!=-1?this._maxRetries+1:1;let l=0;let u;while(l<s){u=await this.requestRaw(o,r);if(u&&u.message&&u.message.statusCode===a.Unauthorized){let e;for(let t=0;t<this.handlers.length;t++){if(this.handlers[t].canHandleAuthentication(u)){e=this.handlers[t];break}}if(e){return e.handleAuthentication(this,o,r)}else{return u}}let t=this._maxRedirects;while(c.indexOf(u.message.statusCode)!=-1&&this._allowRedirects&&t>0){const s=u.message.headers["location"];if(!s){break}let a=new URL(s);if(i.protocol=="https:"&&i.protocol!=a.protocol&&!this._allowRedirectDowngrade){throw new Error("Redirect from HTTPS to HTTP protocol. This downgrade is not allowed for security reasons. If you want to allow this behavior, set the allowRedirectDowngrade option to true.")}await u.readBody();if(a.hostname!==i.hostname){for(let e in n){if(e.toLowerCase()==="authorization"){delete n[e]}}}o=this._prepareRequest(e,a,n);u=await this.requestRaw(o,r);t--}if(p.indexOf(u.message.statusCode)==-1){return u}l+=1;if(l<s){await u.readBody();await this._performExponentialBackoff(l)}}return u}dispose(){if(this._agent){this._agent.destroy()}this._disposed=true}requestRaw(e,t){return new Promise(((r,n)=>{let callbackForResult=function(e,t){if(e){n(e)}r(t)};this.requestRawWithCallback(e,t,callbackForResult)}))}requestRawWithCallback(e,t,r){let n;if(typeof t==="string"){e.options.headers["Content-Length"]=Buffer.byteLength(t,"utf8")}let i=false;let handleResult=(e,t)=>{if(!i){i=true;r(e,t)}};let o=e.httpModule.request(e.options,(e=>{let t=new HttpClientResponse(e);handleResult(null,t)}));o.on("socket",(e=>{n=e}));o.setTimeout(this._socketTimeout||3*6e4,(()=>{if(n){n.end()}handleResult(new Error("Request timeout: "+e.options.path),null)}));o.on("error",(function(e){handleResult(e,null)}));if(t&&typeof t==="string"){o.write(t,"utf8")}if(t&&typeof t!=="string"){t.on("close",(function(){o.end()}));t.pipe(o)}else{o.end()}}getAgent(e){let t=new URL(e);return this._getAgent(t)}_prepareRequest(e,t,r){const o={};o.parsedUrl=t;const s=o.parsedUrl.protocol==="https:";o.httpModule=s?i:n;const a=s?443:80;o.options={};o.options.host=o.parsedUrl.hostname;o.options.port=o.parsedUrl.port?parseInt(o.parsedUrl.port):a;o.options.path=(o.parsedUrl.pathname||"")+(o.parsedUrl.search||"");o.options.method=e;o.options.headers=this._mergeHeaders(r);if(this.userAgent!=null){o.options.headers["user-agent"]=this.userAgent}o.options.agent=this._getAgent(o.parsedUrl);if(this.handlers){this.handlers.forEach((e=>{e.prepareRequest(o.options)}))}return o}_mergeHeaders(e){const lowercaseKeys=e=>Object.keys(e).reduce(((t,r)=>(t[r.toLowerCase()]=e[r],t)),{});if(this.requestOptions&&this.requestOptions.headers){return Object.assign({},lowercaseKeys(this.requestOptions.headers),lowercaseKeys(e))}return lowercaseKeys(e||{})}_getExistingOrDefaultHeader(e,t,r){const lowercaseKeys=e=>Object.keys(e).reduce(((t,r)=>(t[r.toLowerCase()]=e[r],t)),{});let n;if(this.requestOptions&&this.requestOptions.headers){n=lowercaseKeys(this.requestOptions.headers)[t]}return e[t]||n||r}_getAgent(e){let t;let a=o.getProxyUrl(e);let l=a&&a.hostname;if(this._keepAlive&&l){t=this._proxyAgent}if(this._keepAlive&&!l){t=this._agent}if(!!t){return t}const u=e.protocol==="https:";let c=100;if(!!this.requestOptions){c=this.requestOptions.maxSockets||n.globalAgent.maxSockets}if(l){if(!s){s=r(294)}const e={maxSockets:c,keepAlive:this._keepAlive,proxy:{...(a.username||a.password)&&{proxyAuth:`${a.username}:${a.password}`},host:a.hostname,port:a.port}};let n;const i=a.protocol==="https:";if(u){n=i?s.httpsOverHttps:s.httpsOverHttp}else{n=i?s.httpOverHttps:s.httpOverHttp}t=n(e);this._proxyAgent=t}if(this._keepAlive&&!t){const e={keepAlive:this._keepAlive,maxSockets:c};t=u?new i.Agent(e):new n.Agent(e);this._agent=t}if(!t){t=u?i.globalAgent:n.globalAgent}if(u&&this._ignoreSslError){t.options=Object.assign(t.options||{},{rejectUnauthorized:false})}return t}_performExponentialBackoff(e){e=Math.min(h,e);const t=f*Math.pow(2,e);return new Promise((e=>setTimeout((()=>e()),t)))}static dateTimeDeserializer(e,t){if(typeof t==="string"){let e=new Date(t);if(!isNaN(e.valueOf())){return e}}return t}async _processResponse(e,t){return new Promise((async(r,n)=>{const i=e.message.statusCode;const o={statusCode:i,result:null,headers:{}};if(i==a.NotFound){r(o)}let s;let l;try{l=await e.readBody();if(l&&l.length>0){if(t&&t.deserializeDates){s=JSON.parse(l,HttpClient.dateTimeDeserializer)}else{s=JSON.parse(l)}o.result=s}o.headers=e.message.headers}catch(e){}if(i>299){let e;if(s&&s.message){e=s.message}else if(l&&l.length>0){e=l}else{e="Failed request: ("+i+")"}let t=new HttpClientError(e,i);t.result=o.result;n(t)}else{r(o)}}))}}t.HttpClient=HttpClient},443:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});function getProxyUrl(e){let t=e.protocol==="https:";let r;if(checkBypass(e)){return r}let n;if(t){n=process.env["https_proxy"]||process.env["HTTPS_PROXY"]}else{n=process.env["http_proxy"]||process.env["HTTP_PROXY"]}if(n){r=new URL(n)}return r}t.getProxyUrl=getProxyUrl;function checkBypass(e){if(!e.hostname){return false}let t=process.env["no_proxy"]||process.env["NO_PROXY"]||"";if(!t){return false}let r;if(e.port){r=Number(e.port)}else if(e.protocol==="http:"){r=80}else if(e.protocol==="https:"){r=443}let n=[e.hostname.toUpperCase()];if(typeof r==="number"){n.push(`${n[0]}:${r}`)}for(let e of t.split(",").map((e=>e.trim().toUpperCase())).filter((e=>e))){if(n.some((t=>t===e))){return true}}return false}t.checkBypass=checkBypass},863:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Bot=void 0;var n=r(366);var i=r(973);var o=r(232);var s=r(46);var a=r(190);var l=function(){function Bot(e,t){this.running=false;this.lastEventId=0;if(!e)throw new Error("Нет токена");this.token=e;this.apiBaseUrl=t&&t.apiUrlBase?t.apiUrlBase:"https://api.icq.net/bot/v1";this.name=t&&t.name?t.name:"NodeBot";this.version=t&&t.version?t.version:"0.0.1";this.timeoutS=t&&t.timeoutS?t.timeoutS:20;this.pollTimeS=t&&t.pollTimeS?t.pollTimeS:60;this.dispatcher=new o.DispatcherMessage(this);this.uin=this.token.split(":")[this.token.split(":").length-1];this.setHttpSession(new n.ICQHttpClient);this.dispatcher.addHandler(new a.SkipDuplicateMessageHandler({}))}Bot.prototype.getDispatcher=function(){return this.dispatcher};Bot.prototype.getUNI=function(){return this.uin};Bot.prototype.getUserAgent=function(){var e="2.0.0-beta";return this.name+"/"+this.version+" (uin="+(this.uin?this.uin:null)+") bot-nodejs/"+e};Bot.prototype.setHttpSession=function(e){this.http=e};Bot.prototype.startPolling=function(){var e=this;try{if(!this.running){console.log("Starting polling.");this.running=true;this.pollingThread=setTimeout((function(t){return e.polling()}))}}catch(e){console.error("Starting polling.",e)}return this};Bot.prototype.polling=function(){var e=this;if(this.running){try{this.eventsGet(this.pollTimeS,this.lastEventId).then((function(t){for(var r=0,n=t.events;r<n.length;r++){var i=n[r];e.dispatcher.dispatch(new s.ICQEvent(i))}e.polling()}))}catch(e){console.error("Exception while polling!",e)}}};Bot.prototype.stop=function(){if(this.running){console.log("Stopping bot.");this.running=false}return this};Bot.prototype.eventsGet=function(e,t){var r=this;return this.http.get(this.apiBaseUrl+"/events/get",{token:this.token,lastEventId:t,pollTime:e},{"user-agent":this.getUserAgent()}).then((function(e){return new Promise((function(t,n){if(e.events){e.events.forEach((function(e){r.lastEventId=r.lastEventId>e.eventId?r.lastEventId:e.eventId}))}t(e)}))}))};Bot.prototype.selfGet=function(){return this.http.get(this.apiBaseUrl+"/self/get",{token:this.token},{"user-agent":this.getUserAgent()})};Bot.prototype.sendText=function(e,t,r,n,i,o,s){if(r===void 0){r=""}if(n===void 0){n=""}if(i===void 0){i=""}var a={token:this.token,chatId:e,text:t.toString()};if(r)a["replyMsgId"]=r;if(n)a["forwardChatId"]=n;if(i)a["forwardMsgId"]=i;if(o){var l=this.getICQButtonList(o);if(l)a["inlineKeyboardMarkup"]=JSON.stringify(l)}if(s){if(!s.mode){a["format"]=JSON.stringify(s.range)}else{a["parseMode"]=`${s.mode}`}}return this.http.get(this.apiBaseUrl+"/messages/sendText",a,{"user-agent":this.getUserAgent()})};Bot.prototype.getICQButtonList=function(e){if(!e)return null;var t=[];if(Array.isArray(e[0])){for(var r=0,n=e;r<n.length;r++){var i=n[r];var o=[];for(var s=0,a=i;s<a.length;s++){var l=a[s];o.push(l.getQueryStructure())}t.push(o)}return t}else if(Array.isArray(e)){for(var u=0,c=e;u<c.length;u++){var l=c[u];t.push(l.getQueryStructure())}return[t]}else{return[[e.getQueryStructure()]]}};Bot.prototype.sendFile=function(e,t,r,n,o,s,a,l,u){if(r){var c=new i.FormDataICQ;c.append("token",this.token);c.append("chatId",e);if(n)c.append("caption",n);if(o)c.append("replyMsgId",o);if(s)c.append("forwardChatId",s);if(a)c.append("forwardMsgId",a);c.appendFile("file",r);if(l){var p=this.getICQButtonList(l);if(p)c.append("inlineKeyboardMarkup",p)}if(u){if(!u.mode){c.append("format",JSON.stringify(u.range))}else{c.append("parseMode",u.mode)}}return this.http.post(this.apiBaseUrl+"/messages/sendFile",c,{"user-agent":this.getUserAgent()})}else{var d={token:this.token,chatId:e,fileId:t};if(n)d["caption"]=n;if(o)d["replyMsgId"]=o;if(s)d["forwardChatId"]=s;if(a)d["forwardMsgId"]=a;if(l){var p=this.getICQButtonList(l);if(p)d["inlineKeyboardMarkup"]=JSON.stringify(p)}if(u){if(!u.mode){d["format"]=JSON.stringify(u.range)}else{d["parseMode"]=u.mode}}return this.http.get(this.apiBaseUrl+"/messages/sendFile",d,{"user-agent":this.getUserAgent()})}};Bot.prototype.sendVoice=function(e,t,r,n,o,s,a){if(r){var l=new i.FormDataICQ;l.append("token",this.token);l.append("chatId",e);l.append("fileId",t);if(n)l.append("replyMsgId",n);if(o)l.append("forwardChatId",o);if(s)l.append("forwardMsgId",s);if(a){var u=this.getICQButtonList(a);if(u)l.append("inlineKeyboardMarkup",u)}l.appendFile("file",r);return this.http.post(this.apiBaseUrl+"/messages/sendVoice",l,{"user-agent":this.getUserAgent()})}else{var c={token:this.token,chatId:e,fileId:t};if(n)c["replyMsgId"]=n;if(o)c["forwardChatId"]=o;if(s)c["forwardMsgId"]=s;if(a){var u=this.getICQButtonList(a);if(u)c["inlineKeyboardMarkup"]=JSON.stringify(u)}return this.http.get(this.apiBaseUrl+"/messages/sendVoice",c,{"user-agent":this.getUserAgent()})}};Bot.prototype.editText=function(e,t,r,n,i){var o={token:this.token,chatId:e,msgId:t,text:r};if(n){var s=this.getICQButtonList(n);if(s)o["inlineKeyboardMarkup"]=JSON.stringify(s)}if(i){if(!i.mode){o["format"]=JSON.stringify(i.range)}else{o["parseMode"]=i.mode}}return this.http.get(this.apiBaseUrl+"/messages/editText",o,{"user-agent":this.getUserAgent()})};Bot.prototype.deleteMessages=function(e,t){return this.http.get(this.apiBaseUrl+"/messages/deleteMessages",{token:this.token,chatId:e,msgId:t},{"user-agent":this.getUserAgent()})};Bot.prototype.answerCallbackQuery=function(e,t,r,n){var i={token:this.token,queryId:e,text:t};if(r)i["showAlert"]=r;if(n)i["url"]=n;return this.http.get(this.apiBaseUrl+"/messages/answerCallbackQuery",i,{"user-agent":this.getUserAgent()})};Bot.prototype.sendActions=function(e,t){return this.http.get(this.apiBaseUrl+"/chats/sendActions",{token:this.token,chatId:e,actions:t},{"user-agent":this.getUserAgent()})};Bot.prototype.getChatInfo=function(e){return this.http.get(this.apiBaseUrl+"/chats/getInfo",{token:this.token,chatId:e},{"user-agent":this.getUserAgent()})};Bot.prototype.getChatAdmins=function(e){return this.http.get(this.apiBaseUrl+"/chats/getAdmins",{token:this.token,chatId:e},{"user-agent":this.getUserAgent()})};Bot.prototype.getFileInfo=function(e){return this.http.get(this.apiBaseUrl+"/files/getInfo",{token:this.token,fileId:e},{"user-agent":this.getUserAgent()})};Bot.prototype.pinMessage=function(e,t){return this.http.get(this.apiBaseUrl+"/chats/pinMessage",{token:this.token,chatId:e,msgId:t},{"user-agent":this.getUserAgent()})};Bot.prototype.unpinMessage=function(e,t){return this.http.get(this.apiBaseUrl+"/chats/unpinMessage",{token:this.token,chatId:e,msgId:t},{"user-agent":this.getUserAgent()})};Bot.prototype.setTitle=function(e,t){return this.http.get(this.apiBaseUrl+"/chats/setTitle",{token:this.token,chatId:e,title:t},{"user-agent":this.getUserAgent()})};Bot.prototype.setAbout=function(e,t){return this.http.get(this.apiBaseUrl+"/chats/setAbout",{token:this.token,chatId:e,about:t},{"user-agent":this.getUserAgent()})};Bot.prototype.setRules=function(e,t){return this.http.get(this.apiBaseUrl+"/chats/setRules",{token:this.token,chatId:e,rules:t},{"user-agent":this.getUserAgent()})};Bot.prototype.setAvatar=function(e,t){var r=new i.FormDataICQ;r.append("token",this.token);r.append("chatId",e);r.appendFile("image",t);return this.http.post(this.apiBaseUrl+"/chats/avatar/set",r,{"user-agent":this.getUserAgent()})};Bot.prototype.getMembers=function(e,t){var r={token:this.token,chatId:e};if(t)r["cursor"]=t;return this.http.get(this.apiBaseUrl+"/chats/getMembers",r,{"user-agent":this.getUserAgent()})};Bot.prototype.deleteMembers=function(e,t){var r={token:this.token,chatId:e,members:JSON.stringify(t)};return this.http.get(this.apiBaseUrl+"/chats/members/delete",r,{"user-agent":this.getUserAgent()})};Bot.prototype.getBlockedUsers=function(e){return this.http.get(this.apiBaseUrl+"/chats/getBlockedUsers",{token:this.token,chatId:e},{"user-agent":this.getUserAgent()})};Bot.prototype.getPendingUsers=function(e){return this.http.get(this.apiBaseUrl+"/chats/getPendingUsers",{token:this.token,chatId:e},{"user-agent":this.getUserAgent()})};Bot.prototype.blockUser=function(e,t,r){var n={token:this.token,chatId:e,userId:t};if(r)n["delLastMessages"]=true;return this.http.get(this.apiBaseUrl+"/chats/blockUser",n,{"user-agent":this.getUserAgent()})};Bot.prototype.unblockUser=function(e,t){var r={token:this.token,chatId:e,userId:t};return this.http.get(this.apiBaseUrl+"/chats/unblockUser",r,{"user-agent":this.getUserAgent()})};Bot.prototype.resolvePending=function(e,t,r,n){var i={token:this.token,chatId:e};if(t)i["approve"]=true;if(n)i["everyone"]=true;if(r)i["userId"]=r;if(n==!!r)throw new Error("Должен быть указан один из двух параметров: userId или everyone. Эти параметры не могут быть указаны одновременно.");return this.http.get(this.apiBaseUrl+"/chats/resolvePending",i,{"user-agent":this.getUserAgent()})};return Bot}();t.Bot=l},232:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DispatcherMessage=void 0;var r=function(){function DispatcherMessage(e){this.bot=e;this.handlers=[]}DispatcherMessage.prototype.getBot=function(){return this.bot};DispatcherMessage.prototype.getHandlers=function(){return this.handlers};DispatcherMessage.prototype.addHandler=function(e){if(this.handlers.findIndex((function(t){return t===e}))>=0)return;this.handlers.push(e)};DispatcherMessage.prototype.removeHandler=function(e){if(this.handlers.indexOf(e)!=-1){this.handlers=this.handlers.filter((function(t){return t!==e}))}};DispatcherMessage.prototype.dispatch=function(e){var t=this;try{for(var r=0,n=this.handlers.filter((function(r){return r.check(e,t)}));r<n.length;r++){var i=n[r];i.handle(e,this)}}catch(e){console.error("Caught '"+e+"' exception, stopping dispatching.");this.bot.stop()}};return DispatcherMessage}();t.DispatcherMessage=r},973:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FormDataICQ=void 0;var n=r(747);var i=function(){function FormDataICQ(){this.data=[];this.files=[];this.razdel="----WebKitFormBoundary"+(Math.random()*Math.pow(10,18)).toString(16)}FormDataICQ.prototype.getBoundary=function(){return this.razdel};FormDataICQ.prototype.append=function(e,t){this.data.push({name:e,value:t})};FormDataICQ.prototype.appendFile=function(e,t){if(!n.existsSync(t))throw"File not exist "+t;this.files.push({name:e,filename:t})};FormDataICQ.prototype.toString=function(){var e="";for(var t=0,r=this.files;t<r.length;t++){var i=r[t];e+="--"+this.razdel+"\r\n";var o=i.filename.split(/(\/|\\)/g);var s=i.filename.split(".");var a=s[s.length-1];e+='Content-Disposition: form-data; name="'+i.name+'"; filename="'+o[o.length-1]+'"\r\n';if(/(jpg|jpeg|png|gif)/i.test(a)){e+='Content-Type: "image/'+a+'"\r\n\r\n'}else if(/(txt|html|css|cmd|htm|json)/i.test(a)){e+='Content-Type: "text/'+a+'"\r\n\r\n'}else{e+='Content-Type: "application/octet-stream"\r\n\r\n'}e+=n.readFileSync(i.filename,"latin1")}for(var l=0,u=this.data;l<u.length;l++){var i=u[l];if(e)e+="\r\n";e+="--"+this.razdel+"\r\n";e+='Content-Disposition: form-data; name="'+i.name+'"\r\n\r\n';e+=Buffer.from(i.value.toString(),"utf8").toString("latin1")}e+="\r\n--"+this.razdel+"--";return e};return FormDataICQ}();t.FormDataICQ=i},119:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ICQButton=void 0;var r=function(){function ICQButton(e,t,r){if(r===void 0){r=null}this.text=e;this.callbackData=t;this.url=r}ICQButton.prototype.getQueryStructure=function(){if(this.url){return{text:this.text,url:this.url}}else{return{text:this.text,callbackData:this.callbackData}}};return ICQButton}();t.ICQButton=r},46:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ICQEvent=void 0;var n=r(268);var i=function(){function ICQEvent(e){this.type=e.type;this.data=e.payload;if(this.type==n.EventType.NEW_MESSAGE||this.type==n.EventType.EDITED_MESSAGE||this.type==n.EventType.PINNED_MESSAGE){this.text=this.data.text;this.messageAuthor=this.data.from}if(this.data&&this.data.chat){this.fromChatId=this.data.chat.chatId}}return ICQEvent}();t.ICQEvent=i},366:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ICQHttpClient=void 0;var n=r(835);var i=r(211);var o=function(){function ICQHttpClient(){}ICQHttpClient.prototype.get=function(e,t,r){return new Promise((function(o,s){var a="?";for(var l in t){if(Array.isArray(t[l])){for(var u=0,c=t[l];u<c.length;u++){var p=c[u];a+=encodeURIComponent(l)+"="+encodeURIComponent(p)+"&"}}else{a+=encodeURIComponent(l)+"="+encodeURIComponent(t[l])+"&"}}a=a.slice(0,-1);console.log(a);var d=new n.URL(e);var h=i.request({host:d.hostname,port:d.port,path:""+d.pathname+a,method:"GET",headers:{"user-agent":r["user-agent"]}},(function(e){e.setEncoding("utf8");var t="";e.on("data",(function(e){t+=e}));e.on("end",(function(e){try{o(JSON.parse(t.toString()))}catch(e){console.log(e.message)}}))}));h.on("error",(function(e){s(e)}));h.end()}))};ICQHttpClient.prototype.post=function(e,t,r){return new Promise((function(o,s){var a=new n.URL(e);var l=t.toString();var u=i.request({host:a.hostname,path:a.pathname,port:a.port,method:"POST",headers:{"Content-Type":"multipart/form-data; boundary="+t.getBoundary(),"user-agent":r["user-agent"]}},(function(e){e.setEncoding("utf8");var t="";e.on("data",(function(e){t+=e}));e.on("end",(function(){o(JSON.parse(t.toString()))}))}));u.on("error",(function(e){s(e)}));u.write(l,"latin1");u.end()}))};return ICQHttpClient}();t.ICQHttpClient=o},190:function(e,t,r){"use strict";var n=this&&this.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r))e[r]=t[r]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();Object.defineProperty(t,"__esModule",{value:true});t.SkipDuplicateMessageHandler=void 0;var i=r(200);var o=function(e){n(SkipDuplicateMessageHandler,e);function SkipDuplicateMessageHandler(t){var r=e.call(this,null,null)||this;r.cache=t;if(!r.cache)r.cache={};return r}SkipDuplicateMessageHandler.prototype.check=function(t,r){if(e.prototype.check.call(this,t,r)){for(var n in this.cache){if(n&&n==t.data.msgId&&this.cache[n]==t.text){throw new Error("Caught StopDispatching id'"+n+"' exception, stopping dispatching.")}}this.cache[t.data.msgId]=t.text}return true};return SkipDuplicateMessageHandler}(i.MessageHandler);t.SkipDuplicateMessageHandler=o},123:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(863);var i=r(200);var o=r(539);var s=r(119);var a=function(){function ICQ(){}ICQ.Button=s.ICQButton;ICQ.Bot=n.Bot;ICQ.Filter=o.Filter;ICQ.Handler={HelpCommand:i.HelpCommandHandler,Message:i.MessageHandler,NewChatMembers:i.NewChatMembersHandler,LeftChatMembers:i.LeftChatMembersHandler,PinnedMessage:i.PinnedMessageHandler,UnPinnedMessage:i.UnPinnedMessageHandler,EditedMessage:i.EditedMessageHandler,DeletedMessage:i.DeletedMessageHandler,Command:i.CommandHandler,StartCommand:i.StartCommandHandler,FeedbackCommand:i.FeedbackCommandHandler,UnknownCommand:i.UnknownCommandHandler,All:i.DefaultHandler,BotButtonCommand:i.BotButtonCommandHandler};return ICQ}();t.default=a},566:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.PayLoadFileType=t.PartsType=void 0;var r;(function(e){e["FILE"]="file";e["STICKER"]="sticker";e["MENTION"]="mention";e["VOICE"]="voice";e["FORWARD"]="forward";e["REPLY"]="reply"})(r=t.PartsType||(t.PartsType={}));var n;(function(e){e["IMAGE"]="image";e["VIDEO"]="video";e["AUDIO"]="audio"})(n=t.PayLoadFileType||(t.PayLoadFileType={}))},268:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.EventType=void 0;var r;(function(e){e["NEW_MESSAGE"]="newMessage";e["EDITED_MESSAGE"]="editedMessage";e["DELETED_MESSAGE"]="deletedMessage";e["PINNED_MESSAGE"]="pinnedMessage";e["UNPINNED_MESSAGE"]="unpinnedMessage";e["NEW_CHAT_MEMBERS"]="newChatMembers";e["LEFT_CHAT_MEMBERS"]="leftChatMembers";e["CHANGED_CHAT_INFO"]="changedChatInfo";e["CALLBACK_QUERY"]="callbackQuery"})(r=t.EventType||(t.EventType={}))},539:function(e,t,r){"use strict";var n=this&&this.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r))e[r]=t[r]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();Object.defineProperty(t,"__esModule",{value:true});t.Filter=t.FilterComposite=t.TypeFilterOperation=t.URLFilter=t.ReplyFilter=t.ForwardFilter=t.MentionFilter=t.StickerFilter=t.AudioFilter=t.VideoFilter=t.ImageFilter=t.FileFilter=t.SenderFilter=t.RegexpFilter=t.CommandFilter=t.MessageFilter=void 0;var i=r(566);var o=function(){function MessageFilter(){}MessageFilter.prototype.filter=function(e){return e.data["text"]&&e["text"].length>0};return MessageFilter}();t.MessageFilter=o;var s=function(e){n(CommandFilter,e);function CommandFilter(){var t=e!==null&&e.apply(this,arguments)||this;t.COMMAND_PREFIXES=["/","."];return t}CommandFilter.prototype.filter=function(t){return e.prototype.filter.call(this,t)&&this.COMMAND_PREFIXES.findIndex((function(e){return e===t.data.text.trim()[0]}))>=0};return CommandFilter}(o);t.CommandFilter=s;var a=function(e){n(RegexpFilter,e);function RegexpFilter(t){var r=e.call(this)||this;r.pattern=t;return r}RegexpFilter.prototype.filter=function(t){return e.prototype.filter.call(this,t)&&this.pattern.test(t.data["text"])};return RegexpFilter}(o);t.RegexpFilter=a;var l=function(e){n(SenderFilter,e);function SenderFilter(t){var r=e.call(this)||this;r.user_id=t;return r}SenderFilter.prototype.filter=function(t){return e.prototype.filter.call(this,t)&&t.data["from"]&&t.data["from"]["userId"]==this.user_id};return SenderFilter}(o);t.SenderFilter=l;var u=function(e){n(FileFilter,e);function FileFilter(){return e!==null&&e.apply(this,arguments)||this}FileFilter.prototype.filter=function(t){return e.prototype.filter.call(this,t)&&t.data["parts"]&&t.data["parts"].findIndex((function(e){return e&&e.type==i.PartsType.FILE}))>=0};return FileFilter}(o);t.FileFilter=u;var c=function(e){n(ImageFilter,e);function ImageFilter(){return e!==null&&e.apply(this,arguments)||this}ImageFilter.prototype.filter=function(t){return e.prototype.filter.call(this,t)&&t.data["parts"].findIndex((function(e){return e&&e["payload"]&&e.payload["type"]&&e.payload.type==i.PayLoadFileType.IMAGE}))>=0};return ImageFilter}(u);t.ImageFilter=c;var p=function(e){n(VideoFilter,e);function VideoFilter(){return e!==null&&e.apply(this,arguments)||this}VideoFilter.prototype.filter=function(t){return e.prototype.filter.call(this,t)&&t.data["parts"].findIndex((function(e){return e&&e["payload"]&&e.payload["type"]&&e.payload.type==i.PayLoadFileType.VIDEO}))>=0};return VideoFilter}(u);t.VideoFilter=p;var d=function(e){n(AudioFilter,e);function AudioFilter(){return e!==null&&e.apply(this,arguments)||this}AudioFilter.prototype.filter=function(t){return e.prototype.filter.call(this,t)&&t.data["parts"].findIndex((function(e){return e&&e["payload"]&&e.payload["type"]&&e.payload.type==i.PayLoadFileType.AUDIO}))>=0};return AudioFilter}(u);t.AudioFilter=d;var h=function(e){n(StickerFilter,e);function StickerFilter(){return e!==null&&e.apply(this,arguments)||this}StickerFilter.prototype.filter=function(t){return e.prototype.filter.call(this,t)&&t.data["parts"]&&t.data["parts"].findIndex((function(e){return e&&e.type==i.PartsType.STICKER}))>=0};return StickerFilter}(o);t.StickerFilter=h;var f=function(e){n(MentionFilter,e);function MentionFilter(t){var r=e.call(this)||this;r.userId=t;return r}MentionFilter.prototype.filter=function(t){var r=this;return e.prototype.filter.call(this,t)&&t.data["parts"]&&t.data["parts"].findIndex((function(e){return e&&e.type==i.PartsType.MENTION&&(!r.userId||e.payload.userId==r.userId)}))>=0};return MentionFilter}(o);t.MentionFilter=f;var g=function(e){n(ForwardFilter,e);function ForwardFilter(){return e!==null&&e.apply(this,arguments)||this}ForwardFilter.prototype.filter=function(e){return e.data["parts"]&&e.data.parts.findIndex((function(e){return e&&e.type==i.PartsType.FORWARD}))>=0};return ForwardFilter}(o);t.ForwardFilter=g;var m=function(e){n(ReplyFilter,e);function ReplyFilter(){return e!==null&&e.apply(this,arguments)||this}ReplyFilter.prototype.filter=function(t){return e.prototype.filter.call(this,t)&&t.data["parts"]&&t.data.parts.findIndex((function(e){return e&&e.type==i.PartsType.REPLY}))>=0};return ReplyFilter}(o);t.ReplyFilter=m;var y=function(e){n(URLFilter,e);function URLFilter(){return e.call(this,/^\s*https?:\/\/\S+\s*$/i)||this}URLFilter.prototype.filter=function(t){return e.prototype.filter.call(this,t)&&!(new u).filter(t)};return URLFilter}(a);t.URLFilter=y;var v;(function(e){e[e["and"]=1]="and";e[e["or"]=2]="or";e[e["not"]=3]="not"})(v=t.TypeFilterOperation||(t.TypeFilterOperation={}));var C=function(){function FilterComposite(e,t,r){this.type=e;this.leftFilter=t;this.rightFilter=r}FilterComposite.and=function(e,t){return new FilterComposite(v.and,e,t)};FilterComposite.or=function(e,t){return new FilterComposite(v.or,e,t)};FilterComposite.not=function(e){return new FilterComposite(v.not,e)};FilterComposite.prototype.filter=function(e){switch(this.type){case v.and:return this.leftFilter.filter(e)&&this.rightFilter.filter(e);case v.or:return this.leftFilter.filter(e)||this.rightFilter.filter(e);case v.not:return!this.leftFilter.filter(e)}throw"Not type filter"};return FilterComposite}();t.FilterComposite=C;var _=function(){function Filter(){}Filter.message=new o;Filter.command=new s;Filter.file=new u;Filter.image=new c;Filter.video=new p;Filter.audio=new d;Filter.media=C.or(C.or(Filter.image,Filter.video),Filter.audio);Filter.data=C.and(Filter.file,C.not(Filter.media));Filter.sticker=new h;Filter.url=new y;Filter.text=C.and(Filter.message,C.not(C.or(C.or(C.or(Filter.command,Filter.sticker),Filter.file),Filter.url)));Filter.regexp=a;Filter.mention=f;Filter.forward=new g;Filter.reply=new m;Filter.sender=l;return Filter}();t.Filter=_},200:function(e,t,r){"use strict";var n=this&&this.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r))e[r]=t[r]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();var i=this&&this.__awaiter||function(e,t,r,n){function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,i){function fulfilled(e){try{step(n.next(e))}catch(e){i(e)}}function rejected(e){try{step(n["throw"](e))}catch(e){i(e)}}function step(e){e.done?r(e.value):adopt(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))};var o=this&&this.__generator||function(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(s[Symbol.iterator]=function(){return this}),s;function verb(e){return function(t){return step([e,t])}}function step(s){if(n)throw new TypeError("Generator is already executing.");while(r)try{if(n=1,i&&(o=s[0]&2?i["return"]:s[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,s[1])).done)return o;if(i=0,o)s=[s[0]&2,o.value];switch(s[0]){case 0:case 1:o=s;break;case 4:r.label++;return{value:s[1],done:false};case 5:r.label++;i=s[1];s=[0];continue;case 7:s=r.ops.pop();r.trys.pop();continue;default:if(!(o=r.trys,o=o.length>0&&o[o.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!o||s[1]>o[0]&&s[1]<o[3])){r.label=s[1];break}if(s[0]===6&&r.label<o[1]){r.label=o[1];o=s;break}if(o&&r.label<o[2]){r.label=o[2];r.ops.push(s);break}if(o[2])r.ops.pop();r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e];i=0}finally{n=o=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:true}}};Object.defineProperty(t,"__esModule",{value:true});t.BotButtonCommandHandler=t.UnknownCommandHandler=t.FeedbackCommandHandler=t.StartCommandHandler=t.HelpCommandHandler=t.CommandHandler=t.DeletedMessageHandler=t.EditedMessageHandler=t.MessageHandler=t.UnPinnedMessageHandler=t.PinnedMessageHandler=t.LeftChatMembersHandler=t.NewChatMembersHandler=t.DefaultHandler=t.HandlerBase=void 0;var s=r(539);var a=r(268);var l=r(190);var u=function(){function HandlerBase(e,t){this.filters=e;this.callback=t}HandlerBase.prototype.check=function(e,t){return!this.filters||this.filters.filter(e)};HandlerBase.prototype.handle=function(e,t){if(this.callback){this.callback(t.getBot(),e)}};return HandlerBase}();t.HandlerBase=u;var c=function(e){n(DefaultHandler,e);function DefaultHandler(t){if(t===void 0){t=null}return e.call(this,null,t)||this}DefaultHandler.prototype.check=function(t,r){return e.prototype.check.call(this,t,r)&&!this.any(t,r)};DefaultHandler.prototype.any=function(e,t){for(var r=0,n=t.getHandlers();r<n.length;r++){var i=n[r];if(i!=this&&!(i instanceof l.SkipDuplicateMessageHandler)){if(i.check(e,t))return true}}return false};return DefaultHandler}(u);t.DefaultHandler=c;var p=function(e){n(NewChatMembersHandler,e);function NewChatMembersHandler(){return e!==null&&e.apply(this,arguments)||this}NewChatMembersHandler.prototype.check=function(t,r){return e.prototype.check.call(this,t,r)&&t.type==a.EventType.NEW_CHAT_MEMBERS};return NewChatMembersHandler}(u);t.NewChatMembersHandler=p;var d=function(e){n(LeftChatMembersHandler,e);function LeftChatMembersHandler(){return e!==null&&e.apply(this,arguments)||this}LeftChatMembersHandler.prototype.check=function(t,r){return e.prototype.check.call(this,t,r)&&t.type==a.EventType.LEFT_CHAT_MEMBERS};return LeftChatMembersHandler}(u);t.LeftChatMembersHandler=d;var h=function(e){n(PinnedMessageHandler,e);function PinnedMessageHandler(){return e!==null&&e.apply(this,arguments)||this}PinnedMessageHandler.prototype.check=function(t,r){return e.prototype.check.call(this,t,r)&&t.type==a.EventType.PINNED_MESSAGE};return PinnedMessageHandler}(u);t.PinnedMessageHandler=h;var f=function(e){n(UnPinnedMessageHandler,e);function UnPinnedMessageHandler(){return e!==null&&e.apply(this,arguments)||this}UnPinnedMessageHandler.prototype.check=function(t,r){return e.prototype.check.call(this,t=t,r=r)&&t.type==a.EventType.UNPINNED_MESSAGE};return UnPinnedMessageHandler}(u);t.UnPinnedMessageHandler=f;var g=function(e){n(MessageHandler,e);function MessageHandler(){return e!==null&&e.apply(this,arguments)||this}MessageHandler.prototype.check=function(t,r){return e.prototype.check.call(this,t,r)&&t.type==a.EventType.NEW_MESSAGE};return MessageHandler}(u);t.MessageHandler=g;var m=function(e){n(EditedMessageHandler,e);function EditedMessageHandler(){return e!==null&&e.apply(this,arguments)||this}EditedMessageHandler.prototype.check=function(t,r){return e.prototype.check.call(this,t,r)&&t.type==a.EventType.EDITED_MESSAGE};return EditedMessageHandler}(u);t.EditedMessageHandler=m;var y=function(e){n(DeletedMessageHandler,e);function DeletedMessageHandler(){return e!==null&&e.apply(this,arguments)||this}DeletedMessageHandler.prototype.check=function(t,r){return e.prototype.check.call(this,t,r)&&t.type==a.EventType.DELETED_MESSAGE};return DeletedMessageHandler}(u);t.DeletedMessageHandler=y;var v=function(e){n(CommandHandler,e);function CommandHandler(t,r,n){if(t===void 0){t=null}if(r===void 0){r=null}if(n===void 0){n=null}var i=e.call(this,r,n)||this;i.filters=r?r:s.Filter.command;i.callback=n;i.command=t;return i}CommandHandler.prototype.check=function(t,r){if(e.prototype.check.call(this,t,r)){if(!this.command)return true;var n=t.data.text.split(" ")[0].toLowerCase().replace(/^(.|\/)/,"");if(Array.isArray(this.command))return this.command.findIndex((function(e){return e.toLowerCase()==n}))>=0;return this.command==n}return false};CommandHandler.prototype.any=function(e,t){for(var r=0,n=t.getHandlers();r<n.length;r++){var i=n[r];if(i!=this&&i instanceof CommandHandler){if(i.check(e,t))return true}}return false};return CommandHandler}(g);t.CommandHandler=v;var C=function(e){n(HelpCommandHandler,e);function HelpCommandHandler(t,r){return e.call(this,"help",t,r)||this}return HelpCommandHandler}(v);t.HelpCommandHandler=C;var _=function(e){n(StartCommandHandler,e);function StartCommandHandler(t,r){return e.call(this,"start",t,r)||this}return StartCommandHandler}(v);t.StartCommandHandler=_;var k=function(e){n(FeedbackCommandHandler,e);function FeedbackCommandHandler(t,r,n,i,o,s){if(r===void 0){r="Feedback from {source}: {message}"}if(n===void 0){n="Got it!"}if(i===void 0){i=null}if(o===void 0){o="feedback"}if(s===void 0){s=null}var a=e.call(this,o,s)||this;a.callback=a.message_cb;a.target=t;a.message=r;a.reply=n;a.error_reply=i;return a}FeedbackCommandHandler.prototype.check=function(t,r){return e.prototype.check.call(this,t,r)};FeedbackCommandHandler.prototype.message_cb=function(e,t){return i(this,void 0,void 0,(function(){var r,n,i,s,a,s;return o(this,(function(o){switch(o.label){case 0:r=t.data["chat"]["chatId"];n=t.data["text"].split(" ");n.shift();i=n.join(" ").trim();if(!i)return[3,4];return[4,e.sendText(this.target,this.message.replace(/\{source\}/i,r).replace(/\{message\}/i,i))];case 1:s=o.sent();if(!s.ok)console.log("Не удалось отправить запрос sendText");if(!(this.reply!=""))return[3,3];return[4,e.sendText(r,this.reply)];case 2:a=o.sent();if(!a.ok)console.log("Не удалось отправить запрос sendText");o.label=3;case 3:return[3,6];case 4:if(!(this.error_reply!=""))return[3,6];return[4,e.sendText(r,this.error_reply)];case 5:s=o.sent();if(!s.ok)console.log("Не удалось отправить запрос sendText");o.label=6;case 6:return[2]}}))}))};return FeedbackCommandHandler}(v);t.FeedbackCommandHandler=k;var w=function(e){n(UnknownCommandHandler,e);function UnknownCommandHandler(t,r){return e.call(this,null,t,r)||this}UnknownCommandHandler.prototype.check=function(t,r){var n=this;return e.prototype.check.call(this,t,r)&&r.handlers.findIndex((function(e){return e!=n&&e.check(t,r)}))==-1};UnknownCommandHandler.prototype.handle=function(t,r){e.prototype.handle.call(this,t,r);throw new Error("UnknownCommandHandler")};return UnknownCommandHandler}(v);t.UnknownCommandHandler=w;var E=function(e){n(BotButtonCommandHandler,e);function BotButtonCommandHandler(){return e!==null&&e.apply(this,arguments)||this}BotButtonCommandHandler.prototype.check=function(t,r){return e.prototype.check.call(this,t,r)&&t.type==a.EventType.CALLBACK_QUERY};return BotButtonCommandHandler}(u);t.BotButtonCommandHandler=E},294:(e,t,r)=>{e.exports=r(219)},219:(e,t,r)=>{"use strict";var n=r(631);var i=r(16);var o=r(605);var s=r(211);var a=r(614);var l=r(357);var u=r(669);t.httpOverHttp=httpOverHttp;t.httpsOverHttp=httpsOverHttp;t.httpOverHttps=httpOverHttps;t.httpsOverHttps=httpsOverHttps;function httpOverHttp(e){var t=new TunnelingAgent(e);t.request=o.request;return t}function httpsOverHttp(e){var t=new TunnelingAgent(e);t.request=o.request;t.createSocket=createSecureSocket;t.defaultPort=443;return t}function httpOverHttps(e){var t=new TunnelingAgent(e);t.request=s.request;return t}function httpsOverHttps(e){var t=new TunnelingAgent(e);t.request=s.request;t.createSocket=createSecureSocket;t.defaultPort=443;return t}function TunnelingAgent(e){var t=this;t.options=e||{};t.proxyOptions=t.options.proxy||{};t.maxSockets=t.options.maxSockets||o.Agent.defaultMaxSockets;t.requests=[];t.sockets=[];t.on("free",(function onFree(e,r,n,i){var o=toOptions(r,n,i);for(var s=0,a=t.requests.length;s<a;++s){var l=t.requests[s];if(l.host===o.host&&l.port===o.port){t.requests.splice(s,1);l.request.onSocket(e);return}}e.destroy();t.removeSocket(e)}))}u.inherits(TunnelingAgent,a.EventEmitter);TunnelingAgent.prototype.addRequest=function addRequest(e,t,r,n){var i=this;var o=mergeOptions({request:e},i.options,toOptions(t,r,n));if(i.sockets.length>=this.maxSockets){i.requests.push(o);return}i.createSocket(o,(function(t){t.on("free",onFree);t.on("close",onCloseOrRemove);t.on("agentRemove",onCloseOrRemove);e.onSocket(t);function onFree(){i.emit("free",t,o)}function onCloseOrRemove(e){i.removeSocket(t);t.removeListener("free",onFree);t.removeListener("close",onCloseOrRemove);t.removeListener("agentRemove",onCloseOrRemove)}}))};TunnelingAgent.prototype.createSocket=function createSocket(e,t){var r=this;var n={};r.sockets.push(n);var i=mergeOptions({},r.proxyOptions,{method:"CONNECT",path:e.host+":"+e.port,agent:false,headers:{host:e.host+":"+e.port}});if(e.localAddress){i.localAddress=e.localAddress}if(i.proxyAuth){i.headers=i.headers||{};i.headers["Proxy-Authorization"]="Basic "+new Buffer(i.proxyAuth).toString("base64")}c("making CONNECT request");var o=r.request(i);o.useChunkedEncodingByDefault=false;o.once("response",onResponse);o.once("upgrade",onUpgrade);o.once("connect",onConnect);o.once("error",onError);o.end();function onResponse(e){e.upgrade=true}function onUpgrade(e,t,r){process.nextTick((function(){onConnect(e,t,r)}))}function onConnect(i,s,a){o.removeAllListeners();s.removeAllListeners();if(i.statusCode!==200){c("tunneling socket could not be established, statusCode=%d",i.statusCode);s.destroy();var l=new Error("tunneling socket could not be established, "+"statusCode="+i.statusCode);l.code="ECONNRESET";e.request.emit("error",l);r.removeSocket(n);return}if(a.length>0){c("got illegal response body from proxy");s.destroy();var l=new Error("got illegal response body from proxy");l.code="ECONNRESET";e.request.emit("error",l);r.removeSocket(n);return}c("tunneling connection has established");r.sockets[r.sockets.indexOf(n)]=s;return t(s)}function onError(t){o.removeAllListeners();c("tunneling socket could not be established, cause=%s\n",t.message,t.stack);var i=new Error("tunneling socket could not be established, "+"cause="+t.message);i.code="ECONNRESET";e.request.emit("error",i);r.removeSocket(n)}};TunnelingAgent.prototype.removeSocket=function removeSocket(e){var t=this.sockets.indexOf(e);if(t===-1){return}this.sockets.splice(t,1);var r=this.requests.shift();if(r){this.createSocket(r,(function(e){r.request.onSocket(e)}))}};function createSecureSocket(e,t){var r=this;TunnelingAgent.prototype.createSocket.call(r,e,(function(n){var o=e.request.getHeader("host");var s=mergeOptions({},r.options,{socket:n,servername:o?o.replace(/:.*$/,""):e.host});var a=i.connect(0,s);r.sockets[r.sockets.indexOf(n)]=a;t(a)}))}function toOptions(e,t,r){if(typeof e==="string"){return{host:e,port:t,localAddress:r}}return e}function mergeOptions(e){for(var t=1,r=arguments.length;t<r;++t){var n=arguments[t];if(typeof n==="object"){var i=Object.keys(n);for(var o=0,s=i.length;o<s;++o){var a=i[o];if(n[a]!==undefined){e[a]=n[a]}}}}return e}var c;if(process.env.NODE_DEBUG&&/\btunnel\b/.test(process.env.NODE_DEBUG)){c=function(){var e=Array.prototype.slice.call(arguments);if(typeof e[0]==="string"){e[0]="TUNNEL: "+e[0]}else{e.unshift("TUNNEL:")}console.error.apply(console,e)}}else{c=function(){}}t.debug=c},144:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});t.run=void 0;const i=r(186);const o=n(r(747));const s=n(r(123));const a="token";const l="to";const u="message";const c="file";const run=async(e=i.getInput,t=i.setFailed)=>{try{const t=e(a);const r=new s.default.Bot(t);const n=e(l);const i=e(u);if(i){r.sendText(n,i)}const p=e(c);if(p){if(!o.default.existsSync(p)){throw new Error(`File ${p} doesn't exist`)}r.sendFile(n,Buffer.from(p).toString("base64"),p)}}catch(e){t(e.message)}};t.run=run;(0,t.run)()},357:e=>{"use strict";e.exports=require("assert")},614:e=>{"use strict";e.exports=require("events")},747:e=>{"use strict";e.exports=require("fs")},605:e=>{"use strict";e.exports=require("http")},211:e=>{"use strict";e.exports=require("https")},631:e=>{"use strict";e.exports=require("net")},87:e=>{"use strict";e.exports=require("os")},622:e=>{"use strict";e.exports=require("path")},16:e=>{"use strict";e.exports=require("tls")},835:e=>{"use strict";e.exports=require("url")},669:e=>{"use strict";e.exports=require("util")}};var t={};function __nccwpck_require__(r){var n=t[r];if(n!==undefined){return n.exports}var i=t[r]={exports:{}};var o=true;try{e[r].call(i.exports,i,i.exports,__nccwpck_require__);o=false}finally{if(o)delete t[r]}return i.exports}if(typeof __nccwpck_require__!=="undefined")__nccwpck_require__.ab=__dirname+"/";var r=__nccwpck_require__(144);module.exports=r})();