(()=>{"use strict";var t={351:function(t,e,r){var n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)if(Object.hasOwnProperty.call(t,r))e[r]=t[r];e["default"]=t;return e};Object.defineProperty(e,"__esModule",{value:true});const i=n(r(87));const o=r(278);function issueCommand(t,e,r){const n=new Command(t,e,r);process.stdout.write(n.toString()+i.EOL)}e.issueCommand=issueCommand;function issue(t,e=""){issueCommand(t,{},e)}e.issue=issue;const a="::";class Command{constructor(t,e,r){if(!t){t="missing.command"}this.command=t;this.properties=e;this.message=r}toString(){let t=a+this.command;if(this.properties&&Object.keys(this.properties).length>0){t+=" ";let e=true;for(const r in this.properties){if(this.properties.hasOwnProperty(r)){const n=this.properties[r];if(n){if(e){e=false}else{t+=","}t+=`${r}=${escapeProperty(n)}`}}}}t+=`${a}${escapeData(this.message)}`;return t}}function escapeData(t){return o.toCommandValue(t).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A")}function escapeProperty(t){return o.toCommandValue(t).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/:/g,"%3A").replace(/,/g,"%2C")}},186:function(t,e,r){var n=this&&this.__awaiter||function(t,e,r,n){function adopt(t){return t instanceof r?t:new r((function(e){e(t)}))}return new(r||(r=Promise))((function(r,i){function fulfilled(t){try{step(n.next(t))}catch(t){i(t)}}function rejected(t){try{step(n["throw"](t))}catch(t){i(t)}}function step(t){t.done?r(t.value):adopt(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))};var i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)if(Object.hasOwnProperty.call(t,r))e[r]=t[r];e["default"]=t;return e};Object.defineProperty(e,"__esModule",{value:true});const o=r(351);const a=r(717);const s=r(278);const l=i(r(87));const u=i(r(622));var p;(function(t){t[t["Success"]=0]="Success";t[t["Failure"]=1]="Failure"})(p=e.ExitCode||(e.ExitCode={}));function exportVariable(t,e){const r=s.toCommandValue(e);process.env[t]=r;const n=process.env["GITHUB_ENV"]||"";if(n){const e="_GitHubActionsFileCommandDelimeter_";const n=`${t}<<${e}${l.EOL}${r}${l.EOL}${e}`;a.issueCommand("ENV",n)}else{o.issueCommand("set-env",{name:t},r)}}e.exportVariable=exportVariable;function setSecret(t){o.issueCommand("add-mask",{},t)}e.setSecret=setSecret;function addPath(t){const e=process.env["GITHUB_PATH"]||"";if(e){a.issueCommand("PATH",t)}else{o.issueCommand("add-path",{},t)}process.env["PATH"]=`${t}${u.delimiter}${process.env["PATH"]}`}e.addPath=addPath;function getInput(t,e){const r=process.env[`INPUT_${t.replace(/ /g,"_").toUpperCase()}`]||"";if(e&&e.required&&!r){throw new Error(`Input required and not supplied: ${t}`)}return r.trim()}e.getInput=getInput;function setOutput(t,e){process.stdout.write(l.EOL);o.issueCommand("set-output",{name:t},e)}e.setOutput=setOutput;function setCommandEcho(t){o.issue("echo",t?"on":"off")}e.setCommandEcho=setCommandEcho;function setFailed(t){process.exitCode=p.Failure;error(t)}e.setFailed=setFailed;function isDebug(){return process.env["RUNNER_DEBUG"]==="1"}e.isDebug=isDebug;function debug(t){o.issueCommand("debug",{},t)}e.debug=debug;function error(t){o.issue("error",t instanceof Error?t.toString():t)}e.error=error;function warning(t){o.issue("warning",t instanceof Error?t.toString():t)}e.warning=warning;function info(t){process.stdout.write(t+l.EOL)}e.info=info;function startGroup(t){o.issue("group",t)}e.startGroup=startGroup;function endGroup(){o.issue("endgroup")}e.endGroup=endGroup;function group(t,e){return n(this,void 0,void 0,(function*(){startGroup(t);let r;try{r=yield e()}finally{endGroup()}return r}))}e.group=group;function saveState(t,e){o.issueCommand("save-state",{name:t},e)}e.saveState=saveState;function getState(t){return process.env[`STATE_${t}`]||""}e.getState=getState},717:function(t,e,r){var n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)if(Object.hasOwnProperty.call(t,r))e[r]=t[r];e["default"]=t;return e};Object.defineProperty(e,"__esModule",{value:true});const i=n(r(747));const o=n(r(87));const a=r(278);function issueCommand(t,e){const r=process.env[`GITHUB_${t}`];if(!r){throw new Error(`Unable to find environment variable for file command ${t}`)}if(!i.existsSync(r)){throw new Error(`Missing file at path: ${r}`)}i.appendFileSync(r,`${a.toCommandValue(e)}${o.EOL}`,{encoding:"utf8"})}e.issueCommand=issueCommand},278:(t,e)=>{Object.defineProperty(e,"__esModule",{value:true});function toCommandValue(t){if(t===null||t===undefined){return""}else if(typeof t==="string"||t instanceof String){return t}return JSON.stringify(t)}e.toCommandValue=toCommandValue},863:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:true});var n=r(366);var i=r(973);var o=r(232);var a=r(46);var s=r(190);var l=function(){function Bot(t,e){this.running=false;this.lastEventId=0;if(!t)throw new Error("Нет токена");this.token=t;this.apiBaseUrl=e&&e.apiUrlBase?e.apiUrlBase:"https://api.icq.net/bot/v1";this.name=e&&e.name?e.name:"NodeBot";this.version=e&&e.version?e.version:"0.0.1";this.timeoutS=e&&e.timeoutS?e.timeoutS:20;this.pollTimeS=e&&e.pollTimeS?e.pollTimeS:60;this.dispatcher=new o.DispatcherMessage(this);this.uin=this.token.split(":")[this.token.split(":").length-1];this.setHttpSession(new n.ICQHttpClient);this.dispatcher.addHandler(new s.SkipDuplicateMessageHandler({}))}Bot.prototype.getDispatcher=function(){return this.dispatcher};Bot.prototype.getUNI=function(){return this.uin};Bot.prototype.getUserAgent=function(){var t="2.0.0-beta";return this.name+"/"+this.version+" (uin="+(this.uin?this.uin:null)+") bot-nodejs/"+t};Bot.prototype.setHttpSession=function(t){this.http=t};Bot.prototype.startPolling=function(){var t=this;try{if(!this.running){console.log("Starting polling.");this.running=true;this.pollingThread=setTimeout((function(e){return t.polling()}))}}catch(t){console.error("Starting polling.",t)}return this};Bot.prototype.polling=function(){var t=this;if(this.running){try{this.eventsGet(this.pollTimeS,this.lastEventId).then((function(e){for(var r=0,n=e.events;r<n.length;r++){var i=n[r];t.dispatcher.dispatch(new a.ICQEvent(i))}t.polling()}))}catch(t){console.error("Exception while polling!",t)}}};Bot.prototype.stop=function(){if(this.running){console.log("Stopping bot.");this.running=false}return this};Bot.prototype.eventsGet=function(t,e){var r=this;return this.http.get(this.apiBaseUrl+"/events/get",{token:this.token,lastEventId:e,pollTime:t},{"user-agent":this.getUserAgent()}).then((function(t){return new Promise((function(e,n){if(t.events){t.events.forEach((function(t){r.lastEventId=r.lastEventId>t.eventId?r.lastEventId:t.eventId}))}e(t)}))}))};Bot.prototype.selfGet=function(){return this.http.get(this.apiBaseUrl+"/self/get",{token:this.token},{"user-agent":this.getUserAgent()})};Bot.prototype.sendText=function(t,e,r,n,i,o){if(r===void 0){r=""}if(n===void 0){n=""}if(i===void 0){i=""}var a={token:this.token,chatId:t,text:e.toString()};if(r)a["replyMsgId"]=r;if(n)a["forwardChatId"]=n;if(i)a["forwardMsgId"]=i;if(o){var s=this.getICQButtonList(o);if(s)a["inlineKeyboardMarkup"]=JSON.stringify(s)}return this.http.get(this.apiBaseUrl+"/messages/sendText",a,{"user-agent":this.getUserAgent()})};Bot.prototype.getICQButtonList=function(t){if(!t)return null;var e=[];if(Array.isArray(t[0])){for(var r=0,n=t;r<n.length;r++){var i=n[r];var o=[];for(var a=0,s=i;a<s.length;a++){var l=s[a];o.push(l.getQueryStructure())}e.push(o)}return e}else if(Array.isArray(t)){for(var u=0,p=t;u<p.length;u++){var l=p[u];e.push(l.getQueryStructure())}return[e]}else{return[[t.getQueryStructure()]]}};Bot.prototype.sendFile=function(t,e,r,n,o,a,s,l){if(r){var u=new i.FormDataICQ;u.append("token",this.token);u.append("chatId",t);if(n)u.append("caption",n);if(o)u.append("replyMsgId",o);if(a)u.append("forwardChatId",a);if(s)u.append("forwardMsgId",s);u.appendFile("file",r);if(l){var p=this.getICQButtonList(l);if(p)u.append("inlineKeyboardMarkup",p)}return this.http.post(this.apiBaseUrl+"/messages/sendFile",u,{"user-agent":this.getUserAgent()})}else{var c={token:this.token,chatId:t,fileId:e};if(n)c["caption"]=n;if(o)c["replyMsgId"]=o;if(a)c["forwardChatId"]=a;if(s)c["forwardMsgId"]=s;if(l){var p=this.getICQButtonList(l);if(p)c["inlineKeyboardMarkup"]=JSON.stringify(p)}return this.http.get(this.apiBaseUrl+"/messages/sendFile",c,{"user-agent":this.getUserAgent()})}};Bot.prototype.sendVoice=function(t,e,r,n,o,a,s){if(r){var l=new i.FormDataICQ;l.append("token",this.token);l.append("chatId",t);l.append("fileId",e);if(n)l.append("replyMsgId",n);if(o)l.append("forwardChatId",o);if(a)l.append("forwardMsgId",a);if(s){var u=this.getICQButtonList(s);if(u)l.append("inlineKeyboardMarkup",u)}l.appendFile("file",r);return this.http.post(this.apiBaseUrl+"/messages/sendVoice",l,{"user-agent":this.getUserAgent()})}else{var p={token:this.token,chatId:t,fileId:e};if(n)p["replyMsgId"]=n;if(o)p["forwardChatId"]=o;if(a)p["forwardMsgId"]=a;if(s){var u=this.getICQButtonList(s);if(u)p["inlineKeyboardMarkup"]=JSON.stringify(u)}return this.http.get(this.apiBaseUrl+"/messages/sendVoice",p,{"user-agent":this.getUserAgent()})}};Bot.prototype.editText=function(t,e,r,n){var i={token:this.token,chatId:t,msgId:e,text:r};if(n){var o=this.getICQButtonList(n);if(o)i["inlineKeyboardMarkup"]=JSON.stringify(o)}return this.http.get(this.apiBaseUrl+"/messages/editText",i,{"user-agent":this.getUserAgent()})};Bot.prototype.deleteMessages=function(t,e){return this.http.get(this.apiBaseUrl+"/messages/deleteMessages",{token:this.token,chatId:t,msgId:e},{"user-agent":this.getUserAgent()})};Bot.prototype.answerCallbackQuery=function(t,e,r,n){var i={token:this.token,queryId:t,text:e};if(r)i["showAlert"]=r;if(n)i["url"]=n;return this.http.get(this.apiBaseUrl+"/messages/answerCallbackQuery",i,{"user-agent":this.getUserAgent()})};Bot.prototype.sendActions=function(t,e){return this.http.get(this.apiBaseUrl+"/chats/sendActions",{token:this.token,chatId:t,actions:e},{"user-agent":this.getUserAgent()})};Bot.prototype.getChatInfo=function(t){return this.http.get(this.apiBaseUrl+"/chats/getInfo",{token:this.token,chatId:t},{"user-agent":this.getUserAgent()})};Bot.prototype.getChatAdmins=function(t){return this.http.get(this.apiBaseUrl+"/chats/getAdmins",{token:this.token,chatId:t},{"user-agent":this.getUserAgent()})};Bot.prototype.getFileInfo=function(t){return this.http.get(this.apiBaseUrl+"/files/getInfo",{token:this.token,fileId:t},{"user-agent":this.getUserAgent()})};Bot.prototype.pinMessage=function(t,e){return this.http.get(this.apiBaseUrl+"/chats/pinMessage",{token:this.token,chatId:t,msgId:e},{"user-agent":this.getUserAgent()})};Bot.prototype.unpinMessage=function(t,e){return this.http.get(this.apiBaseUrl+"/chats/unpinMessage",{token:this.token,chatId:t,msgId:e},{"user-agent":this.getUserAgent()})};Bot.prototype.setTitle=function(t,e){return this.http.get(this.apiBaseUrl+"/chats/setTitle",{token:this.token,chatId:t,title:e},{"user-agent":this.getUserAgent()})};Bot.prototype.setAbout=function(t,e){return this.http.get(this.apiBaseUrl+"/chats/setAbout",{token:this.token,chatId:t,about:e},{"user-agent":this.getUserAgent()})};Bot.prototype.setRules=function(t,e){return this.http.get(this.apiBaseUrl+"/chats/setRules",{token:this.token,chatId:t,rules:e},{"user-agent":this.getUserAgent()})};Bot.prototype.setAvatar=function(t,e){var r=new i.FormDataICQ;r.append("token",this.token);r.append("chatId",t);r.appendFile("image",e);return this.http.post(this.apiBaseUrl+"/chats/avatar/set",r,{"user-agent":this.getUserAgent()})};Bot.prototype.getMembers=function(t,e){var r={token:this.token,chatId:t};if(e)r["cursor"]=e;return this.http.get(this.apiBaseUrl+"/chats/getMembers",r,{"user-agent":this.getUserAgent()})};Bot.prototype.deleteMembers=function(t,e){var r={token:this.token,chatId:t,members:e};return this.http.get(this.apiBaseUrl+"/chats/members/delete",r,{"user-agent":this.getUserAgent()})};Bot.prototype.getBlockedUsers=function(t){return this.http.get(this.apiBaseUrl+"/chats/getBlockedUsers",{token:this.token,chatId:t},{"user-agent":this.getUserAgent()})};Bot.prototype.getPendingUsers=function(t){return this.http.get(this.apiBaseUrl+"/chats/getPendingUsers",{token:this.token,chatId:t},{"user-agent":this.getUserAgent()})};Bot.prototype.blockUser=function(t,e,r){var n={token:this.token,chatId:t,userId:e};if(r)n["delLastMessages"]=true;return this.http.get(this.apiBaseUrl+"/chats/blockUser",n,{"user-agent":this.getUserAgent()})};Bot.prototype.unblockUser=function(t,e){var r={token:this.token,chatId:t,userId:e};return this.http.get(this.apiBaseUrl+"/chats/unblockUser",r,{"user-agent":this.getUserAgent()})};Bot.prototype.resolvePending=function(t,e,r,n){var i={token:this.token,chatId:t};if(e)i["approve"]=true;if(n)i["everyone"]=true;if(r)i["userId"]=r;if(n==!!r)throw new Error("Должен быть указан один из двух параметров: userId или everyone. Эти параметры не могут быть указаны одновременно.");return this.http.get(this.apiBaseUrl+"/chats/resolvePending",i,{"user-agent":this.getUserAgent()})};return Bot}();e.Bot=l},232:(t,e)=>{Object.defineProperty(e,"__esModule",{value:true});var r=function(){function DispatcherMessage(t){this.bot=t;this.handlers=[]}DispatcherMessage.prototype.getBot=function(){return this.bot};DispatcherMessage.prototype.getHandlers=function(){return this.handlers};DispatcherMessage.prototype.addHandler=function(t){if(this.handlers.findIndex((function(e){return e===t}))>=0)return;this.handlers.push(t)};DispatcherMessage.prototype.removeHandler=function(t){if(this.handlers.indexOf(t)!=-1){this.handlers=this.handlers.filter((function(e){return e!==t}))}};DispatcherMessage.prototype.dispatch=function(t){var e=this;try{for(var r=0,n=this.handlers.filter((function(r){return r.check(t,e)}));r<n.length;r++){var i=n[r];i.handle(t,this)}}catch(t){console.error("Caught '"+t+"' exception, stopping dispatching.");this.bot.stop()}};return DispatcherMessage}();e.DispatcherMessage=r},973:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:true});var n=r(747);var i=function(){function FormDataICQ(){this.data=[];this.files=[];this.razdel="----WebKitFormBoundary"+(Math.random()*Math.pow(10,18)).toString(16)}FormDataICQ.prototype.getBoundary=function(){return this.razdel};FormDataICQ.prototype.append=function(t,e){this.data.push({name:t,value:e})};FormDataICQ.prototype.appendFile=function(t,e){if(!n.existsSync(e))throw"File not exist "+e;this.files.push({name:t,filename:e})};FormDataICQ.prototype.toString=function(){var t="";for(var e=0,r=this.files;e<r.length;e++){var i=r[e];t+="--"+this.razdel+"\r\n";var o=i.filename.split(/(\/|\\)/g);var a=i.filename.split(".");var s=a[a.length-1];t+='Content-Disposition: form-data; name="'+i.name+'"; filename="'+o[o.length-1]+'"\r\n';if(/(jpg|jpeg|png|gif)/i.test(s)){t+='Content-Type: "image/'+s+'"\r\n\r\n'}else if(/(txt|html|css|cmd|htm|json)/i.test(s)){t+='Content-Type: "text/'+s+'"\r\n\r\n'}else{t+='Content-Type: "application/octet-stream"\r\n\r\n'}t+=n.readFileSync(i.filename,"latin1")}for(var l=0,u=this.data;l<u.length;l++){var i=u[l];if(t)t+="\r\n";t+="--"+this.razdel+"\r\n";t+='Content-Disposition: form-data; name="'+i.name+'"\r\n\r\n';t+=Buffer.from(i.value.toString(),"utf8").toString("latin1")}t+="\r\n--"+this.razdel+"--";return t};return FormDataICQ}();e.FormDataICQ=i},119:(t,e)=>{Object.defineProperty(e,"__esModule",{value:true});var r=function(){function ICQButton(t,e,r){if(r===void 0){r=null}this.text=t;this.callbackData=e;this.url=r}ICQButton.prototype.getQueryStructure=function(){if(this.url){return{text:this.text,url:this.url}}else{return{text:this.text,callbackData:this.callbackData}}};return ICQButton}();e.ICQButton=r},46:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:true});var n=r(268);var i=function(){function ICQEvent(t){this.type=t.type;this.data=t.payload;if(this.type==n.EventType.NEW_MESSAGE||this.type==n.EventType.EDITED_MESSAGE||this.type==n.EventType.PINNED_MESSAGE){this.text=this.data.text;this.messageAuthor=this.data.from}if(this.data&&this.data.chat){this.fromChatId=this.data.chat.chatId}}return ICQEvent}();e.ICQEvent=i},366:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:true});var n=r(835);var i=r(211);var o=function(){function ICQHttpClient(){}ICQHttpClient.prototype.get=function(t,e,r){return new Promise((function(o,a){var s="?";for(var l in e){if(Array.isArray(e[l])){for(var u=0,p=e[l];u<p.length;u++){var c=p[u];s+=encodeURIComponent(l)+"="+encodeURIComponent(c)+"&"}}else{s+=encodeURIComponent(l)+"="+encodeURIComponent(e[l])+"&"}}s=s.slice(0,-1);var d=new n.URL(t);var f=i.request({host:d.hostname,port:d.port,path:""+d.pathname+s,method:"GET",headers:{"user-agent":r["user-agent"]}},(function(t){t.setEncoding("utf8");var e="";t.on("data",(function(t){e+=t}));t.on("end",(function(t){try{o(JSON.parse(e.toString()))}catch(t){console.log(t.message)}}))}));f.on("error",(function(t){a(t)}));f.end()}))};ICQHttpClient.prototype.post=function(t,e,r){return new Promise((function(o,a){var s=new n.URL(t);var l=e.toString();var u=i.request({host:s.hostname,path:s.pathname,port:s.port,method:"POST",headers:{"Content-Type":"multipart/form-data; boundary="+e.getBoundary(),"user-agent":r["user-agent"]}},(function(t){t.setEncoding("utf8");var e="";t.on("data",(function(t){e+=t}));t.on("end",(function(){o(JSON.parse(e.toString()))}))}));u.on("error",(function(t){a(t)}));u.write(l,"latin1");u.end()}))};return ICQHttpClient}();e.ICQHttpClient=o},190:function(t,e,r){var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r]};return function(e,r){t(e,r);function __(){this.constructor=e}e.prototype=r===null?Object.create(r):(__.prototype=r.prototype,new __)}}();Object.defineProperty(e,"__esModule",{value:true});var i=r(200);var o=function(t){n(SkipDuplicateMessageHandler,t);function SkipDuplicateMessageHandler(e){var r=t.call(this,null,null)||this;r.cache=e;if(!r.cache)r.cache={};return r}SkipDuplicateMessageHandler.prototype.check=function(e,r){if(t.prototype.check.call(this,e,r)){for(var n in this.cache){if(n&&n==e.data.msgId&&this.cache[n]==e.text){throw new Error("Caught StopDispatching id'"+n+"' exception, stopping dispatching.")}}this.cache[e.data.msgId]=e.text}return true};return SkipDuplicateMessageHandler}(i.MessageHandler);e.SkipDuplicateMessageHandler=o},123:(t,e,r)=>{var n;n={value:true};var i=r(863);var o=r(200);var a=r(539);var s=r(119);var l=function(){function ICQ(){}ICQ.Button=s.ICQButton;ICQ.Bot=i.Bot;ICQ.Filter=a.Filter;ICQ.Handler={HelpCommand:o.HelpCommandHandler,Message:o.MessageHandler,NewChatMembers:o.NewChatMembersHandler,LeftChatMembers:o.LeftChatMembersHandler,PinnedMessage:o.PinnedMessageHandler,UnPinnedMessage:o.UnPinnedMessageHandler,EditedMessage:o.EditedMessageHandler,DeletedMessage:o.DeletedMessageHandler,Command:o.CommandHandler,StartCommand:o.StartCommandHandler,FeedbackCommand:o.FeedbackCommandHandler,UnknownCommand:o.UnknownCommandHandler,All:o.DefaultHandler,BotButtonCommand:o.BotButtonCommandHandler};return ICQ}();e.Z=l},566:(t,e)=>{Object.defineProperty(e,"__esModule",{value:true});var r;(function(t){t["FILE"]="file";t["STICKER"]="sticker";t["MENTION"]="mention";t["VOICE"]="voice";t["FORWARD"]="forward";t["REPLY"]="reply"})(r=e.PartsType||(e.PartsType={}));var n;(function(t){t["IMAGE"]="image";t["VIDEO"]="video";t["AUDIO"]="audio"})(n=e.PayLoadFileType||(e.PayLoadFileType={}))},268:(t,e)=>{Object.defineProperty(e,"__esModule",{value:true});var r;(function(t){t["NEW_MESSAGE"]="newMessage";t["EDITED_MESSAGE"]="editedMessage";t["DELETED_MESSAGE"]="deletedMessage";t["PINNED_MESSAGE"]="pinnedMessage";t["UNPINNED_MESSAGE"]="unpinnedMessage";t["NEW_CHAT_MEMBERS"]="newChatMembers";t["LEFT_CHAT_MEMBERS"]="leftChatMembers";t["CHANGED_CHAT_INFO"]="changedChatInfo";t["CALLBACK_QUERY"]="callbackQuery"})(r=e.EventType||(e.EventType={}))},539:function(t,e,r){var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r]};return function(e,r){t(e,r);function __(){this.constructor=e}e.prototype=r===null?Object.create(r):(__.prototype=r.prototype,new __)}}();Object.defineProperty(e,"__esModule",{value:true});var i=r(566);var o=function(){function MessageFilter(){}MessageFilter.prototype.filter=function(t){return t.data["text"]&&t["text"].length>0};return MessageFilter}();e.MessageFilter=o;var a=function(t){n(CommandFilter,t);function CommandFilter(){var e=t!==null&&t.apply(this,arguments)||this;e.COMMAND_PREFIXES=["/","."];return e}CommandFilter.prototype.filter=function(e){return t.prototype.filter.call(this,e)&&this.COMMAND_PREFIXES.findIndex((function(t){return t===e.data.text.trim()[0]}))>=0};return CommandFilter}(o);e.CommandFilter=a;var s=function(t){n(RegexpFilter,t);function RegexpFilter(e){var r=t.call(this)||this;r.pattern=e;return r}RegexpFilter.prototype.filter=function(e){return t.prototype.filter.call(this,e)&&this.pattern.test(e.data["text"])};return RegexpFilter}(o);e.RegexpFilter=s;var l=function(t){n(SenderFilter,t);function SenderFilter(e){var r=t.call(this)||this;r.user_id=e;return r}SenderFilter.prototype.filter=function(e){return t.prototype.filter.call(this,e)&&e.data["from"]&&e.data["from"]["userId"]==this.user_id};return SenderFilter}(o);e.SenderFilter=l;var u=function(t){n(FileFilter,t);function FileFilter(){return t!==null&&t.apply(this,arguments)||this}FileFilter.prototype.filter=function(e){return t.prototype.filter.call(this,e)&&e.data["parts"]&&e.data["parts"].findIndex((function(t){return t&&t.type==i.PartsType.FILE}))>=0};return FileFilter}(o);e.FileFilter=u;var p=function(t){n(ImageFilter,t);function ImageFilter(){return t!==null&&t.apply(this,arguments)||this}ImageFilter.prototype.filter=function(e){return t.prototype.filter.call(this,e)&&e.data["parts"].findIndex((function(t){return t&&t["payload"]&&t.payload["type"]&&t.payload.type==i.PayLoadFileType.IMAGE}))>=0};return ImageFilter}(u);e.ImageFilter=p;var c=function(t){n(VideoFilter,t);function VideoFilter(){return t!==null&&t.apply(this,arguments)||this}VideoFilter.prototype.filter=function(e){return t.prototype.filter.call(this,e)&&e.data["parts"].findIndex((function(t){return t&&t["payload"]&&t.payload["type"]&&t.payload.type==i.PayLoadFileType.VIDEO}))>=0};return VideoFilter}(u);e.VideoFilter=c;var d=function(t){n(AudioFilter,t);function AudioFilter(){return t!==null&&t.apply(this,arguments)||this}AudioFilter.prototype.filter=function(e){return t.prototype.filter.call(this,e)&&e.data["parts"].findIndex((function(t){return t&&t["payload"]&&t.payload["type"]&&t.payload.type==i.PayLoadFileType.AUDIO}))>=0};return AudioFilter}(u);e.AudioFilter=d;var f=function(t){n(StickerFilter,t);function StickerFilter(){return t!==null&&t.apply(this,arguments)||this}StickerFilter.prototype.filter=function(e){return t.prototype.filter.call(this,e)&&e.data["parts"]&&e.data["parts"].findIndex((function(t){return t&&t.type==i.PartsType.STICKER}))>=0};return StickerFilter}(o);e.StickerFilter=f;var h=function(t){n(MentionFilter,t);function MentionFilter(e){var r=t.call(this)||this;r.userId=e;return r}MentionFilter.prototype.filter=function(e){var r=this;return t.prototype.filter.call(this,e)&&e.data["parts"]&&e.data["parts"].findIndex((function(t){return t&&t.type==i.PartsType.MENTION&&(!r.userId||t.payload.userId==r.userId)}))>=0};return MentionFilter}(o);e.MentionFilter=h;var g=function(t){n(ForwardFilter,t);function ForwardFilter(){return t!==null&&t.apply(this,arguments)||this}ForwardFilter.prototype.filter=function(t){return t.data["parts"]&&t.data.parts.findIndex((function(t){return t&&t.type==i.PartsType.FORWARD}))>=0};return ForwardFilter}(o);e.ForwardFilter=g;var m=function(t){n(ReplyFilter,t);function ReplyFilter(){return t!==null&&t.apply(this,arguments)||this}ReplyFilter.prototype.filter=function(e){return t.prototype.filter.call(this,e)&&e.data["parts"]&&e.data.parts.findIndex((function(t){return t&&t.type==i.PartsType.REPLY}))>=0};return ReplyFilter}(o);e.ReplyFilter=m;var y=function(t){n(URLFilter,t);function URLFilter(){return t.call(this,/^\s*https?:\/\/\S+\s*$/i)||this}URLFilter.prototype.filter=function(e){return t.prototype.filter.call(this,e)&&!(new u).filter(e)};return URLFilter}(s);e.URLFilter=y;var v;(function(t){t[t["and"]=1]="and";t[t["or"]=2]="or";t[t["not"]=3]="not"})(v=e.TypeFilterOperation||(e.TypeFilterOperation={}));var _=function(){function FilterComposite(t,e,r){this.type=t;this.leftFilter=e;this.rightFilter=r}FilterComposite.and=function(t,e){return new FilterComposite(v.and,t,e)};FilterComposite.or=function(t,e){return new FilterComposite(v.or,t,e)};FilterComposite.not=function(t){return new FilterComposite(v.not,t)};FilterComposite.prototype.filter=function(t){switch(this.type){case v.and:return this.leftFilter.filter(t)&&this.rightFilter.filter(t);case v.or:return this.leftFilter.filter(t)||this.rightFilter.filter(t);case v.not:return!this.leftFilter.filter(t)}throw"Not type filter"};return FilterComposite}();e.FilterComposite=_;var C=function(){function Filter(){}Filter.message=new o;Filter.command=new a;Filter.file=new u;Filter.image=new p;Filter.video=new c;Filter.audio=new d;Filter.media=_.or(_.or(Filter.image,Filter.video),Filter.audio);Filter.data=_.and(Filter.file,_.not(Filter.media));Filter.sticker=new f;Filter.url=new y;Filter.text=_.and(Filter.message,_.not(_.or(_.or(_.or(Filter.command,Filter.sticker),Filter.file),Filter.url)));Filter.regexp=s;Filter.mention=h;Filter.forward=new g;Filter.reply=new m;Filter.sender=l;return Filter}();e.Filter=C},200:function(t,e,r){var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r]};return function(e,r){t(e,r);function __(){this.constructor=e}e.prototype=r===null?Object.create(r):(__.prototype=r.prototype,new __)}}();var i=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(i,o){function fulfilled(t){try{step(n.next(t))}catch(t){o(t)}}function rejected(t){try{step(n["throw"](t))}catch(t){o(t)}}function step(t){t.done?i(t.value):new r((function(e){e(t.value)})).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))};var o=this&&this.__generator||function(t,e){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,a;return a={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function verb(t){return function(e){return step([t,e])}}function step(a){if(n)throw new TypeError("Generator is already executing.");while(r)try{if(n=1,i&&(o=i[a[0]&2?"return":a[0]?"throw":"next"])&&!(o=o.call(i,a[1])).done)return o;if(i=0,o)a=[0,o.value];switch(a[0]){case 0:case 1:o=a;break;case 4:r.label++;return{value:a[1],done:false};case 5:r.label++;i=a[1];a=[0];continue;case 7:a=r.ops.pop();r.trys.pop();continue;default:if(!(o=r.trys,o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){r.label=a[1];break}if(a[0]===6&&r.label<o[1]){r.label=o[1];o=a;break}if(o&&r.label<o[2]){r.label=o[2];r.ops.push(a);break}if(o[2])r.ops.pop();r.trys.pop();continue}a=e.call(t,r)}catch(t){a=[6,t];i=0}finally{n=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};Object.defineProperty(e,"__esModule",{value:true});var a=r(539);var s=r(268);var l=r(190);var u=function(){function HandlerBase(t,e){this.filters=t;this.callback=e}HandlerBase.prototype.check=function(t,e){return!this.filters||this.filters.filter(t)};HandlerBase.prototype.handle=function(t,e){if(this.callback){this.callback(e.getBot(),t)}};return HandlerBase}();e.HandlerBase=u;var p=function(t){n(DefaultHandler,t);function DefaultHandler(e){if(e===void 0){e=null}return t.call(this,null,e)||this}DefaultHandler.prototype.check=function(e,r){return t.prototype.check.call(this,e,r)&&!this.any(e,r)};DefaultHandler.prototype.any=function(t,e){for(var r=0,n=e.getHandlers();r<n.length;r++){var i=n[r];if(i!=this&&!(i instanceof l.SkipDuplicateMessageHandler)){if(i.check(t,e))return true}}return false};return DefaultHandler}(u);e.DefaultHandler=p;var c=function(t){n(NewChatMembersHandler,t);function NewChatMembersHandler(){return t!==null&&t.apply(this,arguments)||this}NewChatMembersHandler.prototype.check=function(e,r){return t.prototype.check.call(this,e,r)&&e.type==s.EventType.NEW_CHAT_MEMBERS};return NewChatMembersHandler}(u);e.NewChatMembersHandler=c;var d=function(t){n(LeftChatMembersHandler,t);function LeftChatMembersHandler(){return t!==null&&t.apply(this,arguments)||this}LeftChatMembersHandler.prototype.check=function(e,r){return t.prototype.check.call(this,e,r)&&e.type==s.EventType.LEFT_CHAT_MEMBERS};return LeftChatMembersHandler}(u);e.LeftChatMembersHandler=d;var f=function(t){n(PinnedMessageHandler,t);function PinnedMessageHandler(){return t!==null&&t.apply(this,arguments)||this}PinnedMessageHandler.prototype.check=function(e,r){return t.prototype.check.call(this,e,r)&&e.type==s.EventType.PINNED_MESSAGE};return PinnedMessageHandler}(u);e.PinnedMessageHandler=f;var h=function(t){n(UnPinnedMessageHandler,t);function UnPinnedMessageHandler(){return t!==null&&t.apply(this,arguments)||this}UnPinnedMessageHandler.prototype.check=function(e,r){return t.prototype.check.call(this,e=e,r=r)&&e.type==s.EventType.UNPINNED_MESSAGE};return UnPinnedMessageHandler}(u);e.UnPinnedMessageHandler=h;var g=function(t){n(MessageHandler,t);function MessageHandler(){return t!==null&&t.apply(this,arguments)||this}MessageHandler.prototype.check=function(e,r){return t.prototype.check.call(this,e,r)&&e.type==s.EventType.NEW_MESSAGE};return MessageHandler}(u);e.MessageHandler=g;var m=function(t){n(EditedMessageHandler,t);function EditedMessageHandler(){return t!==null&&t.apply(this,arguments)||this}EditedMessageHandler.prototype.check=function(e,r){return t.prototype.check.call(this,e,r)&&e.type==s.EventType.EDITED_MESSAGE};return EditedMessageHandler}(u);e.EditedMessageHandler=m;var y=function(t){n(DeletedMessageHandler,t);function DeletedMessageHandler(){return t!==null&&t.apply(this,arguments)||this}DeletedMessageHandler.prototype.check=function(e,r){return t.prototype.check.call(this,e,r)&&e.type==s.EventType.DELETED_MESSAGE};return DeletedMessageHandler}(u);e.DeletedMessageHandler=y;var v=function(t){n(CommandHandler,t);function CommandHandler(e,r,n){if(e===void 0){e=null}if(r===void 0){r=null}if(n===void 0){n=null}var i=t.call(this,r,n)||this;i.filters=r?r:a.Filter.command;i.callback=n;i.command=e;return i}CommandHandler.prototype.check=function(e,r){if(t.prototype.check.call(this,e,r)){if(!this.command)return true;var n=e.data.text.split(" ")[0].toLowerCase().replace(/^(.|\/)/,"");if(Array.isArray(this.command))return this.command.findIndex((function(t){return t.toLowerCase()==n}))>=0;return this.command==n}return false};CommandHandler.prototype.any=function(t,e){for(var r=0,n=e.getHandlers();r<n.length;r++){var i=n[r];if(i!=this&&i instanceof CommandHandler){if(i.check(t,e))return true}}return false};return CommandHandler}(g);e.CommandHandler=v;var _=function(t){n(HelpCommandHandler,t);function HelpCommandHandler(e,r){return t.call(this,"help",e,r)||this}return HelpCommandHandler}(v);e.HelpCommandHandler=_;var C=function(t){n(StartCommandHandler,t);function StartCommandHandler(e,r){return t.call(this,"start",e,r)||this}return StartCommandHandler}(v);e.StartCommandHandler=C;var F=function(t){n(FeedbackCommandHandler,t);function FeedbackCommandHandler(e,r,n,i,o,a){if(r===void 0){r="Feedback from {source}: {message}"}if(n===void 0){n="Got it!"}if(i===void 0){i=null}if(o===void 0){o="feedback"}if(a===void 0){a=null}var s=t.call(this,o,a)||this;s.callback=s.message_cb;s.target=e;s.message=r;s.reply=n;s.error_reply=i;return s}FeedbackCommandHandler.prototype.check=function(e,r){return t.prototype.check.call(this,e,r)};FeedbackCommandHandler.prototype.message_cb=function(t,e){return i(this,void 0,void 0,(function(){var r,n,i,a,s,a;return o(this,(function(o){switch(o.label){case 0:r=e.data["chat"]["chatId"];n=e.data["text"].split(" ");n.shift();i=n.join(" ").trim();if(!i)return[3,4];return[4,t.sendText(this.target,this.message.replace(/\{source\}/i,r).replace(/\{message\}/i,i))];case 1:a=o.sent();if(!a.ok)console.log("Не удалось отправить запрос sendText");if(!(this.reply!=""))return[3,3];return[4,t.sendText(r,this.reply)];case 2:s=o.sent();if(!s.ok)console.log("Не удалось отправить запрос sendText");o.label=3;case 3:return[3,6];case 4:if(!(this.error_reply!=""))return[3,6];return[4,t.sendText(r,this.error_reply)];case 5:a=o.sent();if(!a.ok)console.log("Не удалось отправить запрос sendText");o.label=6;case 6:return[2]}}))}))};return FeedbackCommandHandler}(v);e.FeedbackCommandHandler=F;var k=function(t){n(UnknownCommandHandler,t);function UnknownCommandHandler(e,r){return t.call(this,null,e,r)||this}UnknownCommandHandler.prototype.check=function(e,r){var n=this;return t.prototype.check.call(this,e,r)&&r.handlers.findIndex((function(t){return t!=n&&t.check(e,r)}))==-1};UnknownCommandHandler.prototype.handle=function(e,r){t.prototype.handle.call(this,e,r);throw new Error("UnknownCommandHandler")};return UnknownCommandHandler}(v);e.UnknownCommandHandler=k;var I=function(t){n(BotButtonCommandHandler,t);function BotButtonCommandHandler(){return t!==null&&t.apply(this,arguments)||this}BotButtonCommandHandler.prototype.check=function(e,r){return t.prototype.check.call(this,e,r)&&e.type==s.EventType.CALLBACK_QUERY};return BotButtonCommandHandler}(u);e.BotButtonCommandHandler=I},747:t=>{t.exports=require("fs")},211:t=>{t.exports=require("https")},87:t=>{t.exports=require("os")},622:t=>{t.exports=require("path")},835:t=>{t.exports=require("url")}};var e={};function __nccwpck_require__(r){var n=e[r];if(n!==undefined){return n.exports}var i=e[r]={exports:{}};var o=true;try{t[r].call(i.exports,i,i.exports,__nccwpck_require__);o=false}finally{if(o)delete e[r]}return i.exports}(()=>{__nccwpck_require__.n=t=>{var e=t&&t.__esModule?()=>t["default"]:()=>t;__nccwpck_require__.d(e,{a:e});return e}})();(()=>{__nccwpck_require__.d=(t,e)=>{for(var r in e){if(__nccwpck_require__.o(e,r)&&!__nccwpck_require__.o(t,r)){Object.defineProperty(t,r,{enumerable:true,get:e[r]})}}}})();(()=>{__nccwpck_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e)})();(()=>{__nccwpck_require__.r=t=>{if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(t,"__esModule",{value:true})}})();if(typeof __nccwpck_require__!=="undefined")__nccwpck_require__.ab=__dirname+"/";var r={};(()=>{__nccwpck_require__.r(r);__nccwpck_require__.d(r,{run:()=>run});var t=__nccwpck_require__(186);var e=__nccwpck_require__.n(t);var n=__nccwpck_require__(747);var i=__nccwpck_require__.n(n);var o=__nccwpck_require__(123);const a="token";const s="to";const l="message";const u="file";const run=async(e=t.getInput,r=t.setFailed)=>{try{const t=e(a);const r=new o.Z.Bot(t);const n=e(s);const p=e(l);if(p){r.sendText(n,p)}const c=e(u);if(c){if(!i().existsSync(c)){throw new Error(`File ${c} doesn't exist`)}r.sendFile(n,Buffer.from(c).toString("base64"),c)}}catch(t){r(t.message)}};run()})();module.exports=r})();